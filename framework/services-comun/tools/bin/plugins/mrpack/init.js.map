{"version":3,"file":"plugins/mrpack/init.js","mappings":"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","sources":["webpack://services-comun/./modules/net/i18n/index.ts","webpack://services-comun/./tools/src/mrpack/clases/init/app.ts","webpack://services-comun/./tools/src/mrpack/clases/init/attributes.ts","webpack://services-comun/./tools/src/mrpack/clases/init/devel.ts","webpack://services-comun/./tools/src/mrpack/clases/init/ignore.ts","webpack://services-comun/./tools/src/mrpack/clases/init.ts","webpack://services-comun/./tools/src/mrpack/clases/init/sonarlint.ts"],"sourcesContent":["export const soportados = [\n    \"ca\", \"cs\", \"da\", \"de\", \"en\", \"es\", \"eu\", \"fi\", \"fr\", \"gl\", \"hi\", \"hu\", \"it\", \"nl\", \"no\", \"pl\", \"pt\", \"ro\", \"ru\", \"sk\", \"sv\", \"tr\",\n    \"de-DE\", \"de-AT\",\n    \"en-US\", \"en-GB\", \"en-CA\",\n    \"es-ES\", \"es-AR\", \"es-MX\", \"es-CL\", \"es-BO\", \"es-CR\", \"es-DO\", \"es-EC\", \"es-HN\", \"es-PA\", \"es-PE\", \"es-PY\", \"es-UY\", \"es-VE\",\n    \"fr-FR\",\n    \"it-IT\",\n    \"nl-NL\",\n    \"pt-PT\", \"pt-BR\",\n    \"ru-RU\",\n];\nexport const soportado = (lang) => soportados.indexOf(lang) >= 0;\n","export default `\nprocess.env.ZONA ??= \"desarrollo\";\n\nSymbol.dispose ??= Symbol(\"Symbol.dispose\");\nSymbol.asyncDispose ??= Symbol(\"Symbol.asyncDispose\");\n\nrequire(\"./init\");\nrequire(\"source-map-support\").install();\nrequire(\"./output/app\");\n`.trimStart();\n","export default `\n.yarn/releases/*.*js binary\n.yarn/plugins/*.*js binary\n**/tools/bin/**/*.*js binary\n`.trimStart();\n","export default `\n// require(\"source-map-support\").install();\nrequire(\"./app\");\n`.trimStart();\n","export default `\n.DS_Store\n.idea/copilot/\n.idea/dataSources.xml\n.idea/jetClient/state-backup-*.xml\n.idea/watcherTasks.xml\n.idea/php.xml\n.idea/sonarlint/\n.idea/workspace.xml\n.next/\n.pnp.*\n.wrangler/\n.yarn/*\n!.yarn/patches\n!.yarn/plugins\n!.yarn/releases\n!.yarn/sdks\n!.yarn/versions\n**/files/*\n**/output/*\n!**/output/.foreverignore\nconfig.workspaces.json\ni18n/.credenciales\ni18n/**/*.ts\nnode_modules/\nservices-*/files\nservices-*/output\ntmp/\ntsconfig.tsbuildinfo\nvendor/\n**/.env*.local\n`.trimStart();\n","import { isDir, isFile, readDir, readFileString, readJSON, rename, rmdir, safeWrite, unlink, } from 'services-comun/modules/utiles/fs';\nimport { md5 } from 'services-comun/modules/utiles/hash';\nimport { soportados } from 'services-comun/modules/net/i18n';\nimport { Colors } from './colors';\nimport { Comando } from './comando';\nimport { EFramework, ERuntime } from './workspace/service';\nimport { Yarn } from './yarn';\n// import APP_DEPLOYMENT from \"./init/app-deployment\";\nimport APP from './init/app';\nimport ATTRIBUTES from './init/attributes';\nimport DEVEL from './init/devel';\nimport IGNORE from './init/ignore';\nimport SONARLINT from './init/sonarlint';\nexport class Init {\n    /* STATIC */\n    static async init(basedir) {\n        console.log(Colors.colorize([Colors.FgCyan, Colors.Bright], \"Inicializando\"));\n        console.group();\n        const [workspaces, scripts] = await this.initBase(basedir);\n        await this.deleteFiles(basedir);\n        const config = this.reduceConfig([\n            await this.initServices(basedir, workspaces),\n            await this.initScripts(basedir, scripts),\n        ]);\n        await this.initConfig(basedir, workspaces);\n        const cambio = await this.initYarnRC(basedir, config);\n        console.groupEnd();\n        if (cambio || config.cambio) {\n            await Yarn.install(basedir, { verbose: false });\n            return true;\n        }\n        return false;\n    }\n    static reduceConfig(configs) {\n        return configs.reduce((prev, actual) => {\n            return {\n                openTelemetry: prev.openTelemetry || actual.openTelemetry,\n                cambio: prev.cambio || actual.cambio,\n            };\n        }, {\n            openTelemetry: false,\n            cambio: false,\n        });\n    }\n    static async isValid(dir) {\n        return await isDir(dir) && await isFile(`${dir}/package.json`);\n    }\n    static async initBase(basedir) {\n        console.log(Colors.colorize([Colors.FgWhite], \"Inicializando proyecto\"));\n        console.group();\n        const workspaces = [];\n        const scripts = [];\n        const paquete = await readJSON(`${basedir}/package.json`);\n        paquete.scripts = {\n            \"mrlang\": \"yarn workspace services-comun mrlang\",\n            \"mrpack\": \"yarn workspace services-comun mrpack\",\n            \"doctor\": \"yarn dlx @yarnpkg/doctor\",\n            \"devel\": \"yarn mrpack devel -e\",\n            \"devel-f\": \"yarn mrpack devel -e -f\",\n            \"g:devel\": \"cd \\\"$INIT_CWD\\\" && yarn node --watch --no-warnings devel.js\",\n            \"packd\": \"yarn mrpack devel -c\",\n            \"packd-f\": \"yarn mrpack devel -c -f\",\n            \"g:packd\": \"TS_NODE_PROJECT=\\\"webpack/tsconfig.json\\\" yarn workspace services-comun webpack --env entorno=desarrollo --env dir=\\\"$INIT_CWD\\\" --config \\\"webpack/webpack.config.ts\\\"\",\n            // \"g:packd\": \"yarn workspace services-comun webpack --env entorno=desarrollo --env dir=\\\"$INIT_CWD\\\" --config \\\"$INIT_CWD/webpack.develop.config.js\\\"\",\n            // \"deploy\": \"yarn node framework/services-comun/deploy.js $ENV | sh\",\n            \"update\": \"yarn mrpack update\",\n        };\n        if (await isDir(`${basedir}/framework`)) {\n            //const alias: NodeJS.Dict<string> = {};\n            for (const actual of await readDir(`${basedir}/framework`)) {\n                if (await this.isValid(`${basedir}/framework/${actual}`)) {\n                    // try {\n                    //     const subpaquete = await readJSON(`${basedir}/framework/${actual}/package.json`);\n                    //     if (subpaquete.alias!==undefined) {\n                    //         alias[subpaquete.alias] = `yarn workspace ${actual}`;\n                    //     }\n                    // } catch (e) {\n                    // }\n                    paquete.scripts[actual] = `yarn workspace ${actual}`;\n                }\n                else {\n                    await unlink(`${basedir}/framework/${actual}`);\n                }\n            }\n            // paquete.scripts = {\n            //     ...paquete.scripts,\n            //     ...alias,\n            // };\n        }\n        if (await isDir(`${basedir}/services`)) {\n            for (const actual of await readDir(`${basedir}/services`)) {\n                if (await this.isValid(`${basedir}/services/${actual}`)) {\n                    paquete.scripts[actual] = `yarn workspace ${actual}`;\n                    workspaces.push(actual);\n                }\n                else {\n                    await unlink(`${basedir}/services/${actual}`);\n                }\n            }\n        }\n        if (await isDir(`${basedir}/packages`)) {\n            for (const actual of await readDir(`${basedir}/packages`)) {\n                if (await this.isValid(`${basedir}/packages/${actual}`)) {\n                    paquete.scripts[actual] = `yarn workspace ${actual}`;\n                }\n                else {\n                    await unlink(`${basedir}/packages/${actual}`);\n                }\n            }\n        }\n        if (await isDir(`${basedir}/scripts`)) {\n            for (const actual of await readDir(`${basedir}/scripts`)) {\n                if (await this.isValid(`${basedir}/scripts/${actual}`)) {\n                    paquete.scripts[actual] = `yarn workspace ${actual}`;\n                    scripts.push(actual);\n                }\n                else {\n                    await unlink(`${basedir}/scripts/${actual}`);\n                }\n            }\n        }\n        if (await isDir(`${basedir}/i18n`)) {\n            paquete.scripts[\"i18n\"] = \"yarn workspace i18n\";\n        }\n        paquete.workspaces = [\n            \"framework/*\",\n            \"i18n\",\n            \"packages/*\",\n            \"scripts/*\",\n            \"services/*\",\n            \"statics/*\",\n        ];\n        if (paquete.dependencies != undefined) {\n            delete paquete.dependencies;\n        }\n        if (paquete.devDependencies != undefined) {\n            delete paquete.devDependencies;\n        }\n        // paquete.dependencies = {\n        // };\n        // paquete.devDependencies = {\n        //     // concurrently: paquete.devDependencies?.concurrently??\"*\",\n        // };\n        await safeWrite(`${basedir}/.gitattributes`, ATTRIBUTES, true);\n        await safeWrite(`${basedir}/.gitignore`, IGNORE, true);\n        await safeWrite(`${basedir}/.sonarcloud.properties`, SONARLINT, true);\n        await safeWrite(`${basedir}/package.json`, `${JSON.stringify(paquete, null, 2)}\\n`, true);\n        // if (await isDir(`${basedir}/statics/translation`)) {\n        //     await this.migrarTraducciones(basedir);\n        //     paquete.scripts[\"i18n\"] = \"yarn workspace i18n\";\n        //     await safeWrite(`${basedir}/package.json`, `${JSON.stringify(paquete, null, 2)}\\n`, true);\n        // }\n        console.groupEnd();\n        return [workspaces, scripts];\n    }\n    static async migrarTraducciones(basedir) {\n        console.log(Colors.colorize([Colors.FgYellow], \"Migrando traducciones\"));\n        const { status, stdout, stderr } = await Comando.spawn(\"yarn\", [\"workspace\", \"services-comun\", \"mrlang\", \"init\"], { cwd: basedir });\n        console.log(stdout);\n        console.error(stderr);\n        if (status != 0) {\n            return Promise.reject(\"Error al migrar traducciones\");\n        }\n        if (await isDir(`${basedir}/statics`)) {\n            for (const workspace of await readDir(`${basedir}/statics`)) {\n                const json = `${basedir}/statics/${workspace}/json`;\n                if (await isDir(json)) {\n                    for (const modulo of await readDir(json)) {\n                        if (await isDir(`${json}/${modulo}`)) {\n                            await rename(`${json}/${modulo}`, `${basedir}/i18n/.json/${modulo}`);\n                        }\n                    }\n                }\n            }\n        }\n        console.log(Colors.colorize([Colors.FgGreen], \"Actualizando /i18n/package.json\"));\n        const paquete = await readJSON(`${basedir}/i18n/package.json`).catch(() => ({ config: { langs: soportados, modulos: {} } }));\n        await this.parseModulosTraduccion(paquete.config.modulos, `${basedir}/i18n/.json`);\n        await safeWrite(`${basedir}/i18n/package.json`, `${JSON.stringify(paquete, null, 2)}\\n`, true);\n        console.log(Colors.colorize([Colors.FgGreen], \"Borrando directorios antiguos\"));\n        await rmdir(`${basedir}/statics`);\n        if (await isDir(`${basedir}/framework/services-translation`)) {\n            await rmdir(`${basedir}/framework/services-translation`);\n        }\n        await Yarn.install(basedir, { optimize: false });\n    }\n    static async parseModulosTraduccion(modulos, basedir, padre) {\n        const files = await readDir(basedir);\n        for (const file of files) {\n            if (!await isDir(`${basedir}/${file}`)) {\n                continue;\n            }\n            const id = padre ? `${padre}.${file}` : file;\n            let include;\n            let exclude;\n            if (await isFile(`${basedir}/${file}/include.json`)) {\n                include = await readJSON(`${basedir}/${file}/include.json`);\n                await rmdir(`${basedir}/${file}/include.json`);\n            }\n            if (await isFile(`${basedir}/${file}/exclude.json`)) {\n                exclude = await readJSON(`${basedir}/${file}/exclude.json`);\n                await rmdir(`${basedir}/${file}/exclude.json`);\n            }\n            else {\n                exclude = [];\n            }\n            modulos[id] = {\n                include,\n                exclude,\n            };\n            await this.parseModulosTraduccion(modulos, `${basedir}/${file}`, id);\n        }\n    }\n    static async deleteFiles(basedir) {\n        console.log(Colors.colorize([Colors.FgWhite], \"Revisando archivos innecesarios\"));\n        console.group();\n        for (const file of [\"update.sh\", \"run.sh\"]) {\n            if (await isFile(`${basedir}/${file}`)) {\n                console.log(`Eliminando ${Colors.colorize([Colors.FgYellow], file)}`);\n                await unlink(`${basedir}/${file}`);\n            }\n        }\n        for (const actual of await readDir(`${basedir}/framework`)) {\n            for (const file of [\"download.js\", \"upload.js\"]) {\n                if (await isFile(`${basedir}/framework/${actual}/${file}`)) {\n                    console.log(`Eliminando ${Colors.colorize([Colors.FgYellow], `${actual}/${file}`)}`);\n                    await unlink(`${basedir}/framework/${actual}/${file}`);\n                }\n            }\n        }\n        console.groupEnd();\n    }\n    static async initServices(basedir, workspaces) {\n        console.log(Colors.colorize([Colors.FgWhite], \"Inicializando servicios\"));\n        console.group();\n        const config = this.reduceConfig(await Promise.all(workspaces.map(workspace => this.initService(basedir, workspace))));\n        console.groupEnd();\n        return config;\n    }\n    static async initService(basedir, workspace) {\n        const salida = {\n            openTelemetry: false,\n            cambio: false,\n        };\n        const paquetePropio = await readJSON(`${basedir}/framework/${process.env[\"npm_package_name\"]}/package.json`);\n        const paquete = await readJSON(`${basedir}/services/${workspace}/package.json`);\n        const hash = md5(JSON.stringify(paquete));\n        paquete.config ??= {};\n        if (paquete.config.nextjs !== undefined && typeof paquete.config.nextjs !== \"object\") {\n            paquete.config.nextjs = {};\n        }\n        const nextjs = paquete.config.nextjs ?? {};\n        const resources = paquete.config.resources ?? paquete.resources ?? false;\n        const config = {};\n        config.cronjob = paquete.config.cronjob ?? paquete.cronjob ?? false;\n        config.devel = paquete.config.devel ?? paquete.devel ?? true;\n        config.deploy = paquete.config.deploy ?? true;\n        config.generar = paquete.config.generar ?? paquete.generar ?? false;\n        // config.imagen = paquete.config.imagen??\"node:lts-alpine\";\n        config.unico = paquete.config.unico ?? paquete.unico ?? false;\n        config.deps = paquete.config.deps ?? [];\n        const storage = paquete.config.storage ?? paquete.storage;\n        if (Array.isArray(storage)) {\n            if (storage.length > 0) {\n                config.storage = {\n                    buckets: storage,\n                };\n            }\n        }\n        else {\n            config.storage = paquete.config.storage;\n        }\n        config.runtime = paquete.config.runtime ?? (!resources ? ERuntime.node : ERuntime.browser);\n        if (paquete.config.framework !== undefined) {\n            config.framework = paquete.config.framework;\n        }\n        else if (!nextjs.enabled) {\n            config.framework = EFramework.meteored;\n        }\n        else {\n            config.framework = EFramework.nextjs;\n        }\n        config.kustomize = paquete.config.kustomize ?? \"services\";\n        if (paquete.config.credenciales !== undefined) {\n            config.credenciales = paquete.config.credenciales;\n        }\n        else {\n            config.credenciales = nextjs.credenciales ?? [];\n        }\n        config.database = paquete.config.database;\n        config.bundle = paquete.config.bundle ?? {};\n        paquete.config = config;\n        if (paquete.nodemonConfig != undefined) {\n            delete paquete.nodemonConfig;\n        }\n        if (paquete.config.generar) {\n            paquete.scripts ??= {};\n            switch (paquete.config.framework) {\n                case EFramework.meteored:\n                    switch (config.runtime) {\n                        case ERuntime.cfworker:\n                            paquete.scripts.packd = `yarn tsc --noemit --watch`;\n                            paquete.scripts.devel = \"wrangler dev --remote --env test\";\n                            break;\n                        case ERuntime.node:\n                            paquete.scripts.packd = `yarn g:packd`;\n                            if (!paquete.config.cronjob) {\n                                paquete.scripts.devel = \"yarn g:devel\";\n                            }\n                            else {\n                                paquete.scripts.devel = \"yarn node --no-warnings devel.js\";\n                            }\n                            paquete.version = \"0000.00.00-000\";\n                            break;\n                        default:\n                            paquete.scripts.packd = `yarn g:packd`;\n                            break;\n                    }\n                    break;\n                // case EFramework.astro:\n                //     paquete.scripts.build ??= \"astro build\";\n                //     paquete.scripts.dev ??= \"astro dev\";\n                //     paquete.scripts.preview ??= \"astro preview\";\n                //     paquete.scripts.start ??= \"astro start\";\n                //     break;\n                case EFramework.nextjs:\n                    paquete.scripts.dev ??= \"yarn run next dev -- -p 8080\";\n                    break;\n            }\n            if (config.runtime == ERuntime.node) {\n                paquete.dependencies ??= {};\n                paquete.devDependencies ??= {};\n                if (paquete.devDependencies[\"tslib\"] != undefined) {\n                    paquete.dependencies[\"tslib\"] = paquete.devDependencies[\"tslib\"];\n                    delete paquete.devDependencies[\"tslib\"];\n                }\n                else if (paquete.dependencies[\"tslib\"] == undefined) {\n                    paquete.dependencies[\"tslib\"] = \"*\";\n                }\n                if (config.framework != EFramework.nextjs) {\n                    // const hash=`${md5(JSON.stringify(paquete.dependencies))}${md5(JSON.stringify(paquete.devDependencies))}`;\n                    paquete.dependencies[\"source-map-support\"] ??= paquetePropio.devDependencies[\"source-map-support\"] ?? \"*\";\n                    for (const [lib, version] of Object.entries(paquetePropio.devDependencies)) {\n                        if (paquete.dependencies[lib] != undefined) {\n                            paquete.dependencies[lib] = version;\n                        }\n                        if (paquete.devDependencies[lib] != undefined) {\n                            paquete.devDependencies[lib] = version;\n                        }\n                    }\n                    if (!config.cronjob) {\n                        paquete.dependencies[\"@google-cloud/opentelemetry-cloud-trace-exporter\"] ??= paquetePropio.devDependencies[\"@google-cloud/opentelemetry-cloud-trace-exporter\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/api\"] ??= paquetePropio.devDependencies[\"@opentelemetry/api\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/core\"] ??= paquetePropio.devDependencies[\"@opentelemetry/core\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/instrumentation\"] ??= paquetePropio.devDependencies[\"@opentelemetry/instrumentation\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/instrumentation-http\"] ??= paquetePropio.devDependencies[\"@opentelemetry/instrumentation-http\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/resources\"] ??= paquetePropio.devDependencies[\"@opentelemetry/resources\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/sdk-trace-base\"] ??= paquetePropio.devDependencies[\"@opentelemetry/sdk-trace-base\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/sdk-trace-node\"] ??= paquetePropio.devDependencies[\"@opentelemetry/sdk-trace-node\"] ?? \"*\";\n                        paquete.dependencies[\"@opentelemetry/semantic-conventions\"] ??= paquetePropio.devDependencies[\"@opentelemetry/semantic-conventions\"] ?? \"*\";\n                        paquete.dependencies[\"chokidar\"] ??= paquetePropio.devDependencies[\"chokidar\"] ?? \"*\";\n                        paquete.dependencies[\"hexoid\"] ??= paquetePropio.devDependencies[\"hexoid\"] ?? \"*\";\n                        paquete.devDependencies[\"formidable\"] ??= paquetePropio.devDependencies[\"formidable\"] ?? \"*\";\n                        if (paquete.dependencies[\"@google-cloud/trace-agent\"] !== undefined) {\n                            delete paquete.dependencies[\"@google-cloud/trace-agent\"];\n                        }\n                        if (paquete.dependencies[\"@opentelemetry/context-async-hooks\"] !== undefined) {\n                            delete paquete.dependencies[\"@opentelemetry/context-async-hooks\"];\n                        }\n                        if (paquete.dependencies[\"formidable\"] !== undefined) {\n                            delete paquete.dependencies[\"formidable\"];\n                        }\n                        salida.openTelemetry = true;\n                    }\n                    if (paquete.devDependencies[\"source-map-support\"] !== undefined) {\n                        delete paquete.devDependencies[\"source-map-support\"];\n                    }\n                    if (Object.keys(paquete.dependencies).length == 0) {\n                        delete paquete.dependencies;\n                    }\n                    if (Object.keys(paquete.devDependencies).length == 0) {\n                        delete paquete.devDependencies;\n                    }\n                }\n            }\n            await safeWrite(`${basedir}/services/${workspace}/package.json`, `${JSON.stringify(paquete, null, 2)}\\n`, true);\n        }\n        if (config.runtime == ERuntime.node && config.framework != EFramework.nextjs) {\n            await Promise.all([\n                safeWrite(`${basedir}/services/${workspace}/app.js`, APP, true),\n                safeWrite(`${basedir}/services/${workspace}/devel.js`, DEVEL, true),\n                safeWrite(`${basedir}/services/${workspace}/init.js`, ``, false),\n            ]);\n        }\n        if (await isFile(`${basedir}/services/${workspace}/output/.foreverignore`)) {\n            console.log(Colors.colorize([Colors.FgYellow], `Eliminando ${basedir}/services/${workspace}/output/.foreverignore`));\n            await unlink(`${basedir}/services/${workspace}/output/.foreverignore`);\n        }\n        if (await isFile(`${basedir}/services/${workspace}/output/devel.js`)) {\n            console.log(Colors.colorize([Colors.FgYellow], `Eliminando ${basedir}/services/${workspace}/output/devel.js`));\n            await unlink(`${basedir}/services/${workspace}/output/devel.js`);\n        }\n        if (await isFile(`${basedir}/services/${workspace}/output/devel.js.map`)) {\n            console.log(Colors.colorize([Colors.FgYellow], `Eliminando ${basedir}/services/${workspace}/output/devel.js.map`));\n            await unlink(`${basedir}/services/${workspace}/output/devel.js.map`);\n        }\n        if (await isFile(`${basedir}/services/${workspace}/pack.js`)) {\n            console.log(Colors.colorize([Colors.FgYellow], `Eliminando ${basedir}/services/${workspace}/pack.js`));\n            await unlink(`${basedir}/services/${workspace}/pack.js`);\n        }\n        salida.cambio = hash != md5(JSON.stringify(paquete));\n        return salida;\n    }\n    static async initScripts(basedir, scripts) {\n        console.log(Colors.colorize([Colors.FgWhite], \"Inicializando scripts\"));\n        console.group();\n        const config = this.reduceConfig(await Promise.all(scripts.map(script => this.initScript(basedir, script))));\n        console.groupEnd();\n        return config;\n    }\n    static async initScript(basedir, workspace) {\n        const paquete = await readJSON(`${basedir}/scripts/${workspace}/package.json`);\n        const hash = md5(JSON.stringify(paquete));\n        paquete.scripts ??= {};\n        paquete.scripts.packd = `yarn g:packd`;\n        await safeWrite(`${basedir}/scripts/${workspace}/package.json`, `${JSON.stringify(paquete, null, 2)}\\n`, true);\n        return {\n            openTelemetry: false,\n            cambio: hash != md5(JSON.stringify(paquete)),\n        };\n    }\n    static async initConfig(basedir, workspace) {\n        console.log(Colors.colorize([Colors.FgWhite], \"Inicializando configuración de workspaces\"));\n        console.group();\n        const file = `${basedir}/config.workspaces.json`;\n        const salida = {\n            devel: {\n                available: [],\n                disabled: [],\n            },\n            packd: {\n                available: [],\n                disabled: [],\n            },\n            i18n: true,\n            services: {},\n        };\n        if (await isFile(file)) {\n            try {\n                const config = await readJSON(file);\n                salida.devel.disabled.push(...config?.devel?.disabled?.filter(actual => workspace.includes(actual)) ?? []);\n                salida.packd.disabled.push(...config?.packd?.disabled?.filter(actual => workspace.includes(actual)) ?? []);\n                salida.i18n = config.i18n ?? true;\n                salida.services = config.services ?? {};\n            }\n            catch (e) {\n            }\n        }\n        for (const actual of workspace) {\n            if (!salida.devel.disabled.includes(actual)) {\n                salida.devel.available.push(actual);\n            }\n            if (!salida.packd.disabled.includes(actual)) {\n                salida.packd.available.push(actual);\n            }\n        }\n        function sort(a, b) {\n            return a.localeCompare(b);\n        }\n        salida.devel.available = salida.devel.available.toSorted(sort);\n        salida.devel.available.push(\"\");\n        salida.devel.disabled = salida.devel.disabled.toSorted(sort);\n        salida.devel.disabled.push(\"\");\n        salida.packd.available = salida.packd.available.toSorted(sort);\n        salida.packd.available.push(\"\");\n        salida.packd.disabled = salida.packd.disabled.toSorted(sort);\n        salida.packd.disabled.push(\"\");\n        await safeWrite(file, JSON.stringify(salida, null, 2), true);\n        console.groupEnd();\n    }\n    static async initYarnRC(basedir, config) {\n        // if (!config.openTelemetry) {\n        //     return;\n        // }\n        console.log(Colors.colorize([Colors.FgWhite], \"Inicializando configuración de YARN\"));\n        console.group();\n        const file = await readFileString(`${basedir}/.yarnrc.yml`);\n        const lineas = file.split(\"\\n\");\n        const anteriores = [];\n        let corrientes = [];\n        const posteriores = [];\n        let paso = 0;\n        for (const linea of lineas) {\n            if (linea == \"packageExtensions:\") {\n                paso = 1;\n            }\n            else if (linea == \"plugins:\" || linea.startsWith(\"yarnPath:\")) {\n                paso = 2;\n            }\n            switch (paso) {\n                case 0:\n                    anteriores.push(linea.trimEnd());\n                    break;\n                case 1:\n                    corrientes.push(linea.trimEnd());\n                    break;\n                case 2:\n                    posteriores.push(linea.trimEnd());\n                    break;\n            }\n        }\n        let cambio = false;\n        // let nuevo = false;\n        corrientes = corrientes.filter(actual => actual.length > 0);\n        if (corrientes.length == 0) {\n            corrientes.push(\"packageExtensions:\");\n            // nuevo = true;\n        }\n        const libs = {};\n        const exlibs = [`mysql2@*:`];\n        if (config.openTelemetry) {\n            libs[\"@google-cloud/opentelemetry-cloud-trace-exporter\"] = \"@opentelemetry/semantic-conventions\";\n            libs[\"@google-cloud/opentelemetry-resource-util\"] = \"@opentelemetry/api\";\n        }\n        for (const [lib, dep] of Object.entries(libs)) {\n            if (!corrientes.includes(`  \"${lib}@*\":`)) {\n                corrientes.push(`  \"${lib}@*\":`);\n                corrientes.push(`    dependencies:`);\n                corrientes.push(`      \"${dep}\": \"*\"`);\n                cambio = true;\n            }\n        }\n        for (const cadena of exlibs) {\n            const idx = corrientes.indexOf(`  ${cadena}@*:`);\n            if (idx >= 0) {\n                corrientes.splice(idx, 3);\n                cambio = true;\n            }\n        }\n        corrientes = corrientes.filter(actual => actual.length > 0);\n        if (corrientes.length == 1) {\n            corrientes = [];\n            cambio = true;\n        }\n        if (cambio) {\n            if (corrientes.length > 0) {\n                corrientes.push(\"\");\n            }\n            await safeWrite(`${basedir}/.yarnrc.yml`, [...anteriores, ...corrientes, ...posteriores].join(\"\\n\"), true);\n        }\n        console.groupEnd();\n        return cambio;\n    }\n}\n","export default `# Path to sources\nsonar.sources=./framework/**/*,./services/**/*,./packages/**/*,./static/**/*\nsonar.exclusions=./.yarn/**/*,./node_modules/**/*,./.run/*,./framework/**/.run,./deprecated/**/*,./mapping/*,./tmp/**/*,output/**/*,.next/**/*\n#sonar.inclusions=\n\n# Path to tests\n#sonar.tests=\n#sonar.test.exclusions=\n#sonar.test.inclusions=\n\n# Source encoding\n#sonar.sourceEncoding=UTF-8\n\n# Exclusions for copy-paste detection\n#sonar.cpd.exclusions=\n`;\n"],"names":["soportados","trimStart","Init","init","basedir","console","log","colorize","FgCyan","Bright","group","workspaces","scripts","this","initBase","deleteFiles","config","reduceConfig","initServices","initScripts","initConfig","cambio","initYarnRC","groupEnd","install","verbose","configs","reduce","prev","actual","openTelemetry","isValid","dir","FgWhite","paquete","push","undefined","dependencies","devDependencies","JSON","stringify","migrarTraducciones","FgYellow","status","stdout","stderr","spawn","cwd","error","Promise","reject","workspace","json","modulo","FgGreen","catch","langs","modulos","parseModulosTraduccion","optimize","padre","files","file","id","include","exclude","all","map","initService","salida","paquetePropio","process","env","hash","nextjs","resources","cronjob","devel","deploy","generar","unico","deps","storage","Array","isArray","length","buckets","runtime","browser","node","framework","enabled","meteored","kustomize","credenciales","database","bundle","nodemonConfig","cfworker","packd","version","dev","lib","Object","entries","keys","script","initScript","available","disabled","i18n","services","filter","includes","e","sort","a","b","localeCompare","toSorted","lineas","split","anteriores","corrientes","posteriores","paso","linea","startsWith","trimEnd","libs","exlibs","dep","cadena","idx","indexOf","splice","join"],"sourceRoot":""}