{"version":3,"file":"plugins/687.js","mappings":"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","sources":["webpack://services-comun/./modules/utiles/fecha.ts","webpack://services-comun/./tools/src/mrlang/clases/idioma/index.ts","webpack://services-comun/./tools/src/mrlang/clases/idioma/loader.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/loader/json.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/json.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/tmpl/interface.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/tmpl/interface-bundle.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/tmpl/clase.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/mysql.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/literal/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/literal/simple.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/literal/params.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/loader/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/loader/mysql.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/map/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/map/simple.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/map/params.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/plural/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/plural/simple.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/plural/params.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/set/index.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/set/simple.ts","webpack://services-comun/./tools/src/mrlang/clases/modulo/traduccion/set/params.ts"],"sourcesContent":["export var TTimeUnit;\n(function (TTimeUnit) {\n    TTimeUnit[\"DAY\"] = \"d\";\n    TTimeUnit[\"HOUR\"] = \"h\";\n    TTimeUnit[\"MINUTE\"] = \"m\";\n    TTimeUnit[\"SECOND\"] = \"s\";\n    TTimeUnit[\"MILLISECOND\"] = \"ms\";\n})(TTimeUnit || (TTimeUnit = {}));\nexport class Fecha {\n    static MESES = [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"];\n    static SEMANA = [\"Lunes\", \"Martes\", \"Miércoles\", \"Jueves\", \"Viernes\", \"Sábado\", \"Domingo\"];\n    static generarFechaMySQL(date) {\n        return [\n            date.getUTCFullYear(),\n            `00${date.getUTCMonth() + 1}`.slice(-2),\n            `00${date.getUTCDate()}`.slice(-2)\n        ].join(\"-\");\n    }\n    static generarFechaElastic(date, options = {}) {\n        options = {\n            anno: true,\n            mes: true,\n            dia: true,\n            ...options,\n        };\n        const campos = [];\n        if (options.anno) {\n            campos.push(`${date.getUTCFullYear()}`);\n        }\n        if (options.mes) {\n            campos.push(`00${date.getUTCMonth() + 1}`.slice(-2));\n        }\n        if (options.dia) {\n            campos.push(`00${date.getUTCDate()}`.slice(-2));\n        }\n        if (campos.length > 0) {\n            return campos.join(\".\");\n        }\n        return \"\";\n    }\n    static generarFechaNatural(date) {\n        return [\n            `00${date.getUTCDate()}`.slice(-2),\n            `00${date.getUTCMonth() + 1}`.slice(-2),\n            date.getUTCFullYear(),\n        ].join(\"/\");\n    }\n    static generarFechaNaturalConDiaSemana(date) {\n        return `${Fecha.SEMANA[(date.getUTCDay() - 1) >= 0 ? date.getUTCDay() - 1 : Fecha.SEMANA.length - 1]}, ` + [\n            `00${date.getUTCDate()}`.slice(-2),\n            `00${date.getUTCMonth() + 1}`.slice(-2),\n            date.getUTCFullYear(),\n        ].join(\"/\");\n    }\n    static generarFechaBloque(date) {\n        return [\n            date.getUTCFullYear(),\n            `00${date.getUTCMonth() + 1}`.slice(-2),\n            `00${date.getUTCDate()}`.slice(-2),\n        ].join(\"\");\n    }\n    static generarHora(date, tz = true) {\n        return [\n            `00${date.getUTCHours()}`.slice(-2),\n            `00${date.getUTCMinutes()}`.slice(-2),\n            `00${date.getUTCSeconds()}`.slice(-2)\n        ].join(\":\") + (tz ? \" UTC\" : \"\");\n        // const offset = date.getTimezoneOffset();\n        // if (offset!=0) {\n        //     const abs = Math.abs(offset);\n        //     salida += [\n        //         offset>0?\"+\": \"-\",\n        //         `00${Math.floor(abs/60)}`.slice(-2),\n        //         `00${abs%60}`.slice(-2),\n        //     ].join(\"\");\n        // }\n        //\n        // return salida;\n    }\n    static generarHoraMinuto(date, tz = true) {\n        return [\n            `00${date.getUTCHours()}`.slice(-2),\n            `00${date.getUTCMinutes()}`.slice(-2),\n        ].join(\":\") + (tz ? \" UTC\" : \"\");\n    }\n    static generarMarcaMinuto(date) {\n        return [\n            date.getUTCFullYear(),\n            `00${date.getUTCMonth() + 1}`.slice(-2),\n            `00${date.getUTCDate()}`.slice(-2),\n            `00${date.getUTCHours()}`.slice(-2),\n            `00${date.getUTCMinutes()}`.slice(-2)\n        ].join(\"\");\n    }\n    static generarMarcaMes(date = new Date()) {\n        return [\n            date.getUTCFullYear(),\n            `00${date.getUTCMonth() + 1}`.slice(-2)\n        ].join(\"\");\n    }\n    static generarVersion(date) {\n        return `${date.getUTCFullYear()}.${date.getUTCMonth() + 1}.${date.getUTCDate()}-${date.getUTCHours()}${`00${date.getUTCMinutes()}`.slice(-2)}${`00${date.getUTCSeconds()}`.slice(-2)}`;\n    }\n    static generarFechaHoraMySQL(date) {\n        return `${Fecha.generarFechaMySQL(date)} ${Fecha.generarHora(date, false)}`;\n    }\n    static generarFechaHoraNatural(date, tz = true) {\n        return `${Fecha.generarFechaNatural(date)} ${Fecha.generarHoraMinuto(date, tz)}`;\n    }\n    static generarFechaHoraNaturalConDiaSemana(date, tz = true) {\n        return `${Fecha.generarFechaNaturalConDiaSemana(date)} ${Fecha.generarHoraMinuto(date, tz)}`;\n    }\n    static generarIntervaloFechasNatural(inicio, fin) {\n        return inicio.getDate() == fin.getDate() && inicio.getMonth() == fin.getMonth() && inicio.getFullYear() == fin.getFullYear() ?\n            `${inicio.getDate()} ${this.MESES[inicio.getMonth()]}` :\n            `${inicio.getDate()}${inicio.getMonth() != fin.getMonth() ? ` ${this.MESES[inicio.getMonth()]}` : \"\"} - ${fin.getDate()} ${this.MESES[fin.getMonth()]}`;\n    }\n    /**\n     * Genera un objeto Date a partir de una fecha MySQL.\n     * La fecha MySQL debe estar en formato YYYY-MM-DD HH:mm:SS o YYYY-MM-DD.\n     * @param mysql Cadena con la fecha MySQL.\n     */\n    static generarDateDesdeMySQL(mysql) {\n        const dateParts = mysql.split(/[- :]/).map((part) => { return parseInt(part); });\n        return new Date(Date.UTC(dateParts[0], dateParts[1] - 1, dateParts[2], dateParts[3] || 0, dateParts[4] || 0, dateParts[5] || 0));\n    }\n    /**\n     * Devuelve una fecha MySQL como UTC.\n     * Ignora la zona horaria de la fecha de entrada y asigna la zona UTC a ese mismo instante.\n     * @param mysql Fecha mysql\n     */\n    static ignoraTZ(mysql) {\n        return new Date(Date.UTC(mysql.getFullYear(), mysql.getMonth(), mysql.getDate(), mysql.getHours(), mysql.getMinutes(), mysql.getSeconds(), mysql.getMilliseconds()));\n    }\n    static generarLog() {\n        return `[${this.generarFechaHoraNatural(new Date(), false)}]`;\n    }\n    /**\n     * Devuelve la diferencia entre dos fechas en unidades de tiempo.\n     * Indica la unidad de tiempo y la cantidad de unidades de dicha unidad.\n     * @param ms Milisegundos de diferencia.\n     */\n    static determineDiffTime(ms) {\n        const result = {\n            time: ms,\n            unit: TTimeUnit.MILLISECOND\n        };\n        if (ms > 86400000) {\n            result.time = parseFloat((ms / 86400000).toFixed(2));\n            result.unit = TTimeUnit.DAY;\n        }\n        else if (ms > 3600000) {\n            result.time = parseFloat((ms / 3600000).toFixed(2));\n            result.unit = TTimeUnit.HOUR;\n        }\n        else if (ms > 60000) {\n            result.time = parseFloat((ms / 60000).toFixed(2));\n            result.unit = TTimeUnit.MINUTE;\n        }\n        else if (ms > 1000) {\n            result.time = parseFloat((ms / 1000).toFixed(2));\n            result.unit = TTimeUnit.SECOND;\n        }\n        return result;\n    }\n    static getDate(timeZone) {\n        // Convertir a una zona horaria específica\n        return new Date(new Date().toLocaleString('en-US', { timeZone }));\n    }\n}\n","export class Idiomas {\n    /* INSTANCE */\n    defecto;\n    codes;\n    fallbacks;\n    fallbacksDown;\n    constructor(fallbacks) {\n        this.defecto = [];\n        this.codes = [];\n        this.fallbacks = {};\n        this.fallbacksDown = {};\n        this.init(fallbacks);\n    }\n    init(fallbacks) {\n        this.defecto = fallbacks[\"\"] ?? [];\n        this.fallbacksDown = {};\n        delete fallbacks[\"\"];\n        this.fallbacks = fallbacks;\n        const codes = Object.keys(fallbacks);\n        for (const key of Object.keys(fallbacks)) {\n            const values = fallbacks[key];\n            codes.push(...values);\n            for (const value of values) {\n                this.fallbacksDown[value] ??= [key];\n            }\n        }\n        this.codes = [...new Set(codes)].sort();\n        function padres(fallbacks, lang) {\n            const salida = [];\n            const antecesores = fallbacks[lang];\n            if (antecesores == undefined) {\n                return [];\n            }\n            for (const antecesor of antecesores) {\n                if (!salida.includes(antecesor)) {\n                    salida.push(antecesor);\n                    salida.push(...padres(fallbacks, antecesor));\n                }\n            }\n            return [...new Set(salida)];\n        }\n        for (const key of Object.keys(this.fallbacksDown)) {\n            this.fallbacksDown[key] = padres(this.fallbacksDown, key);\n        }\n    }\n    toJSON() {\n        return {\n            ...this.fallbacks,\n            \"\": this.defecto,\n        };\n    }\n    getFallbacksUP(idioma) {\n        return this.fallbacks[idioma] ?? this.defecto;\n    }\n    getFallbacksDOWN(idioma) {\n        return this.fallbacksDown[idioma] ?? this.defecto;\n    }\n    getKeys() {\n        return Object.keys(this.fallbacks);\n    }\n}\n","import { watch } from \"node:fs\";\nimport { Colors } from \"services-comun/modules/utiles/colors\";\nimport { isFile, readJSON } from \"services-comun/modules/utiles/fs\";\nimport { Idiomas } from \"./\";\nimport db from \"../../mysql\";\nexport class IdiomasLoader extends Idiomas {\n    version;\n    /* STATIC */\n    static async fromMySQL() {\n        const fallbacks = {};\n        let fecha = new Date(0);\n        for (const idioma of await db.query(\"SELECT * FROM `idiomas` ORDER BY `idioma`\")) {\n            fallbacks[idioma.idioma] = idioma.fallbacks;\n            fecha = fecha < idioma.version ? idioma.version : fecha;\n        }\n        return new this(fallbacks, fecha);\n    }\n    static fromJSON(data, version) {\n        return new this(data, version ?? new Date(0));\n    }\n    /* INSTANCE */\n    constructor(fallbacks, version) {\n        super(fallbacks);\n        this.version = version;\n    }\n    async reload(basedir) {\n        if (!await isFile(`${basedir}/idiomas.json`)) {\n            console.error(\"No existe el archivo\", Colors.colorize([Colors.FgRed], \"idiomas.json\"));\n            return;\n        }\n        this.init(await readJSON(`${basedir}/idiomas.json`));\n    }\n    addWatch(basedir) {\n        watch(`${basedir}/idiomas.json`, async (_, filename) => {\n            console.log(\"Cambios en \", `${basedir}/idiomas.json`, filename);\n            this.reload(basedir).then(() => { }).catch(() => { });\n        });\n    }\n}\n","import { createHash } from \"node:crypto\";\nimport { mkdir, safeWrite } from \"services-comun/modules/utiles/fs\";\nimport { IdiomasLoader } from \"../idioma/loader\";\nexport class Modulo {\n    config;\n    /* STATIC */\n    static limpiarId(id) {\n        return id\n            .split(\".\")\n            .map((v) => v[0].toUpperCase() + v.substring(1))\n            .join(\"\")\n            .split(\"_\")\n            .map((v) => v[0].toUpperCase() + v.substring(1))\n            .join(\"\")\n            .split(\"-\")\n            .map((v) => v[0].toUpperCase() + v.substring(1))\n            .join(\"\");\n    }\n    /* INSTANCE */\n    id;\n    padre;\n    descripcion;\n    idiomas;\n    customIdiomas;\n    version;\n    hash;\n    jerarquia;\n    submodulos;\n    values;\n    base_id;\n    cambio;\n    className;\n    constructor(original, idiomas, config) {\n        this.config = config;\n        this.id = original.id;\n        this.padre = original.padre;\n        this.descripcion = original.descripcion;\n        if (original.idiomas == null) {\n            this.idiomas = idiomas;\n            this.customIdiomas = undefined;\n        }\n        else {\n            this.idiomas = IdiomasLoader.fromJSON(original.idiomas);\n            this.customIdiomas = this.idiomas;\n        }\n        // if (original.version==undefined || original.hash==undefined) {\n        //     this.version = new Date();\n        //     this.hash = \"\";\n        //     this.config.nuevo = true;\n        // } else {\n        this.version = original.version;\n        this.hash = original.hash;\n        // }\n        this.jerarquia = this.id.split(\".\");\n        this.values = {};\n        this.submodulos = [];\n        this.base_id = this.jerarquia.at(-1) ?? this.id;\n        this.cambio = false;\n        this.className = Modulo.limpiarId(this.id);\n    }\n    toJSON() {\n        return {\n            id: this.base_id,\n            descripcion: this.descripcion,\n            idiomas: this.customIdiomas?.toJSON(),\n            version: this.version.toISOString(),\n            hash: this.hash,\n        };\n    }\n    // public print() {\n    //     console.log(this.id);\n    //     console.log(JSON.stringify(this.toJSON()));\n    //     console.log(JSON.stringify(this.values));\n    //     console.log(\"\");\n    //     this.submodulos.forEach(actual=>actual.print());\n    //     console.log(\"\");\n    // }\n    async load() {\n        this.values = await this.loadValues();\n        this.submodulos = await this.loadSubmodulos();\n    }\n    async refreshHash() {\n        const traducciones = {};\n        for (const [key, value] of Object.entries(this.values)) {\n            if (value == undefined)\n                continue;\n            traducciones[key] = await value.refreshHash();\n        }\n        const submodulos = {};\n        for (const submodulo of this.submodulos) {\n            submodulos[submodulo.base_id] = await submodulo.refreshHash();\n        }\n        const hash = createHash(\"md5\").update(JSON.stringify({\n            id: this.id,\n            padre: this.padre,\n            descripcion: this.descripcion,\n            idiomas: this.customIdiomas,\n            // assets: this.assets,\n            traducciones,\n            submodulos,\n        })).digest(\"hex\");\n        if (hash != this.hash) {\n            this.version = new Date();\n            this.hash = hash;\n            this.cambio = true;\n        }\n        return this.hash;\n    }\n    // protected async guardar(): Promise<void> {\n    //     const idiomas = this.customIdiomas==undefined ? null : JSON.stringify(this.customIdiomas);\n    //     const assets = this.assets==undefined ? null : JSON.stringify(this.assets);\n    //     if (this.nuevo) {\n    //         await db.update(\"UPDATE `modulos` SET `descripcion`=?, `idiomas`=?, `assets`=?, `servicios`=?, `hash`=? WHERE `id`=?\", [this.descripcion, idiomas, assets, JSON.stringify(this.servicios), this.hash, this.id]);\n    //     } else {\n    //         await db.insert(\"INSERT INTO `modulos` (`id`, `descripcion`, `idiomas`, `assets`, `servicios`, `hash`) VALUES (?, ?, ?, ?, ?, ?) ON DUPLICATE KEY UPDATE id=id\", [this.id, this.descripcion, idiomas, assets, JSON.stringify(this.servicios), this.hash]);\n    //         this.nuevo = false;\n    //     }\n    // }\n    async write(dir) {\n        await mkdir(dir, true);\n        await safeWrite(`${dir}/_metadata.json`, JSON.stringify(this.toJSON(), null, 2), true);\n        await safeWrite(`${dir}/_values.json`, JSON.stringify(Object.values(this.values).map(actual => actual?.toJSON()).filter(actual => actual != undefined), null, 2), true);\n    }\n}\n","import { readJSON } from \"services-comun/modules/utiles/fs\";\nimport { TraduccionOrigen, TraduccionTipo } from \"..\";\nimport { TraduccionLiteral } from \"../literal\";\nimport { TraduccionMap } from \"../map\";\nimport { TraduccionPlural } from \"../plural\";\nimport { TraduccionSet } from \"../set\";\nimport { TraduccionLoader } from \".\";\nexport class TraduccionLoaderJSON extends TraduccionLoader {\n    static async build(modulo, id, data) {\n        switch (data.tipo) {\n            case TraduccionTipo.literal:\n                return new TraduccionLiteral(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params,\n                    data: data.values,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas,\n                    version: new Date(data.version),\n                    hash: data.hash,\n                });\n            case TraduccionTipo.plural:\n                return new TraduccionPlural(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params,\n                    data: data.values,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas,\n                    version: new Date(data.version),\n                    hash: data.hash,\n                });\n            case TraduccionTipo.set:\n                return new TraduccionSet(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params,\n                    data: data.values,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas,\n                    version: new Date(data.version),\n                    hash: data.hash,\n                });\n            case TraduccionTipo.map:\n                return new TraduccionMap(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params,\n                    data: data.values,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas,\n                    version: new Date(data.version),\n                    hash: data.hash,\n                });\n        }\n        return Promise.reject(`Tipo de traduccion desconocido ${data.tipo} para la traduccion ${id} del modulo ${modulo.id}`);\n    }\n    static async loadAll(modulo, basedir) {\n        const data = await readJSON(`${basedir}/${modulo.jerarquia.join(\"/\")}/_values.json`);\n        const result = [];\n        for (const traduccion of data) {\n            if (traduccion.values == undefined) {\n                continue;\n            }\n            result.push(this.build(modulo, traduccion.id, {\n                id: traduccion.id,\n                origen: traduccion.origen ?? TraduccionOrigen.auto,\n                tipo: traduccion.tipo ?? TraduccionTipo.literal,\n                params: traduccion.params,\n                values: traduccion.values,\n                descripcion: traduccion.descripcion ?? \"\",\n                idiomas: traduccion.idiomas,\n                version: new Date(traduccion.version ?? 0).toISOString(),\n                hash: traduccion.hash ?? \"\",\n            }));\n        }\n        const resultados = await Promise.all(result);\n        const salida = {};\n        for (const traduccion of resultados) {\n            salida[traduccion.id] = traduccion;\n        }\n        return salida;\n    }\n}\n","import { watch } from \"node:fs\";\nimport { Fecha } from \"services-comun/modules/utiles/fecha\";\nimport { Colors } from \"services-comun/tools/src/mrpack/clases/colors\";\nimport { isDir, isFile, mkdir, readDir, readJSON, safeWrite, unlink } from \"services-comun/modules/utiles/fs\";\nimport { Modulo } from \".\";\nimport { ModuloMySQL } from \"./mysql\";\nimport { TraduccionLoaderJSON } from \"./traduccion/loader/json\";\nimport { TraduccionLoaderMySQL } from \"./traduccion/loader/mysql\";\nimport claseTMPL from \"./tmpl/clase\";\nimport db from \"../../mysql\";\nimport interfaceTMPL from \"./tmpl/interface\";\nimport interfaceBundleTMPL from \"./tmpl/interface-bundle\";\nexport class ModuloJSON extends Modulo {\n    /* STATIC */\n    static async load(jsondir, id, idiomas, paquete, padre) {\n        const dir = padre != undefined ?\n            `${jsondir}/${padre.jerarquia.join(\"/\")}/${id}` :\n            `${jsondir}/${id}`;\n        if (!await isDir(dir)) {\n            return Promise.reject(`No existe el modulo ${id}`);\n        }\n        let row;\n        let config;\n        if (await isFile(`${dir}/_metadata.json`)) {\n            row = {\n                ...await readJSON(`${dir}/_metadata.json`),\n                id: padre != undefined ? `${padre.id}.${id}` : id,\n            };\n            config = {\n                jsondir,\n                nuevo: false,\n                borrar: false,\n                padre,\n                config: paquete,\n            };\n        }\n        else {\n            row = {\n                id: padre != undefined ? `${padre.id}.${id}` : id,\n            };\n            config = {\n                jsondir,\n                nuevo: false,\n                borrar: true,\n                padre,\n                config: paquete,\n            };\n        }\n        return this.build(row, idiomas, config);\n    }\n    static async loadPadre(jsondir, padre, idiomas, paquete) {\n        const dir = `${jsondir}/${padre.jerarquia.join(\"/\")}`;\n        if (!await isDir(dir)) {\n            return Promise.reject(`No existe el modulo ${padre.jerarquia.join(\"/\")}`);\n        }\n        const files = await readDir(dir);\n        const hijos = [];\n        for (const file of files) {\n            if (await isDir(`${dir}/${file}`)) {\n                hijos.push(file);\n            }\n        }\n        return await Promise.all(hijos.map(hijo => this.load(jsondir, hijo, idiomas, paquete, padre)));\n    }\n    static async build(row, idiomas, config) {\n        const modulo = new this({\n            id: row.id,\n            padre: config.padre?.id,\n            descripcion: row.descripcion ?? \"\",\n            idiomas: row.idiomas,\n            version: new Date(row.version ?? 0),\n            hash: row.hash ?? \"\",\n        }, idiomas, config);\n        await modulo.load();\n        return modulo;\n    }\n    /* INSTANCE */\n    async loadValues() {\n        return TraduccionLoaderJSON.loadAll(this, this.config.jsondir);\n    }\n    async loadSubmodulos() {\n        return ModuloJSON.loadPadre(this.config.jsondir, this, this.idiomas, this.config.config);\n    }\n    async preparePush() {\n        const mysql = await ModuloMySQL.load(this.id, this.config.config, this.idiomas).catch(() => undefined);\n        if (mysql == undefined) {\n            this.config.nuevo = true;\n        }\n        else {\n            if (mysql.hash != this.hash) {\n                console.error(`El modulo ${Colors.colorize([Colors.FgYellow], this.id)} tiene una versión más reciente en mysql`);\n                return Promise.reject();\n            }\n        }\n        for (const submodulo of this.submodulos) {\n            await submodulo.preparePush();\n        }\n        await this.refreshHash();\n    }\n    quitarSubmodulo(submodulo) {\n        const i = this.submodulos.indexOf(submodulo);\n        if (i >= 0) {\n            this.submodulos.splice(i, 1);\n        }\n    }\n    async borrar() {\n        for (const submodulo of this.submodulos) {\n            await submodulo.borrar();\n        }\n        await db.update(\"UPDATE `modulos` SET `borrado`=1 WHERE `id`=?\", [this.id]);\n        await unlink(`${this.config.jsondir}/${this.jerarquia.join(\"/\")}`);\n        this.config.padre?.quitarSubmodulo(this);\n    }\n    async toMySQL() {\n        const idiomas = this.customIdiomas == undefined ? null : JSON.stringify(this.customIdiomas);\n        if (this.config.borrar) {\n            console.log(`Borrando el módulo ${Colors.colorize([Colors.FgRed], this.id)}`);\n            await this.borrar();\n            return;\n        }\n        if (!this.cambio) {\n            console.log(`Ignorando el módulo ${Colors.colorize([Colors.FgYellow], this.id)}`);\n            return;\n        }\n        if (this.config.nuevo) {\n            console.log(`Insertando el módulo ${Colors.colorize([Colors.FgGreen], this.id)}`);\n            await db.insert(\"INSERT INTO `modulos` (`id`, `padre`, `descripcion`, `idiomas`, `version`, `hash`) VALUES (?, ?, ?, ?, ?, ?)\", [this.id, this.config.padre?.id ?? null, this.descripcion, idiomas, this.version, this.hash]);\n            this.config.nuevo = false;\n        }\n        else {\n            console.log(`Actualizando el módulo ${Colors.colorize([Colors.FgGreen], this.id)}`);\n            await db.update(\"UPDATE `modulos` SET `descripcion`=?, `idiomas`=?, `version`=?, `hash`=? WHERE `id`=?\", [this.descripcion, idiomas, this.version, this.hash, this.id]);\n            const values = Object.keys(this.values);\n            if (values.length > 0) {\n                await db.update(\"UPDATE `traducciones` SET `borrado`=1 WHERE `modulo`=? AND `borrado`=0 AND `id` NOT IN (?)\", [this.id, values]);\n            }\n            if (this.submodulos.length > 0) {\n                await db.update(\"UPDATE `modulos` SET `borrado`=1 WHERE `padre`=? AND `borrado`=0 AND `id` NOT IN (?)\", [this.id, this.submodulos.map((modulo) => modulo.id)]);\n            }\n        }\n        this.cambio = false;\n        for (const value of Object.values(this.values)) {\n            if (value != undefined) {\n                if (!await TraduccionLoaderMySQL.existe(this, value.id)) {\n                    value.nuevo = true;\n                }\n                await value.guardar();\n            }\n        }\n        for (const submodulo of this.submodulos) {\n            await submodulo.toMySQL();\n        }\n        await this.write(`${this.config.jsondir}/${this.jerarquia.join(\"/\")}`);\n    }\n    get submodulosFinales() {\n        const include = this.config.config.modulos[this.id]?.include ?? [...this.submodulos.map(modulo => modulo.base_id), ...Object.keys(this.values)];\n        const exclude = this.config.config.modulos[this.id]?.exclude ?? [];\n        const submodulos = [];\n        for (const submodulo of this.submodulos) {\n            if (exclude.includes(submodulo.base_id)) {\n                continue;\n            }\n            if (!include.includes(submodulo.base_id)) {\n                continue;\n            }\n            submodulos.push(submodulo);\n        }\n        return submodulos;\n    }\n    get valoresFinales() {\n        const include = this.config.config.modulos[this.id]?.include ?? [...this.submodulos.map(modulo => modulo.base_id), ...Object.keys(this.values)];\n        const exclude = this.config.config.modulos[this.id]?.exclude ?? [];\n        const valores = [];\n        for (const key of Object.keys(this.values)) {\n            if (exclude.includes(key)) {\n                continue;\n            }\n            if (!include.includes(key)) {\n                continue;\n            }\n            valores.push(this.values[key]);\n        }\n        return valores;\n    }\n    async regenerar(classdir, idiomas = []) {\n        const submodulos = this.submodulosFinales;\n        const valores = this.valoresFinales;\n        const interfaceDir = `${classdir}/${this.id.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}`;\n        await mkdir(interfaceDir, true);\n        const langs = {};\n        const mapping = {};\n        for (const lang of this.config.config.langs) {\n            const seleccionado = this.calcularLang(lang, submodulos, valores);\n            langs[seleccionado] ??= [];\n            langs[seleccionado].push(lang);\n            if (lang != seleccionado) {\n                mapping[lang] = seleccionado;\n            }\n        }\n        const promesas = [];\n        for (const lang of Object.keys(langs)) {\n            promesas.push(this.regenerarEjecutar(classdir, lang, submodulos, valores, idiomas));\n        }\n        promesas.push(safeWrite(`${interfaceDir}/index.ts`, interfaceTMPL({ id: this.id, jerarquia: this.jerarquia, className: this.className, valores, submodulos, lang: this.config.config.lang, mapping }), true), safeWrite(`${interfaceDir}/bundle.ts`, interfaceBundleTMPL({ id: this.id, jerarquia: this.jerarquia, className: this.className, langs: this.config.config.langs, lang: this.config.config.lang, mapping }), true));\n        for (const lang of Object.keys(langs)) {\n            if (!idiomas.includes(lang)) {\n                idiomas.push(lang);\n            }\n        }\n        idiomas.sort();\n        for (const modulo of submodulos) {\n            promesas.push(modulo.regenerar(classdir, idiomas).then(() => { }));\n        }\n        await Promise.all(promesas);\n        return langs;\n    }\n    getJerarquiaIdiomas(lang) {\n        const idiomas = this.customIdiomas ?? this.idiomas;\n        const idiomasJerarquia = [lang];\n        // console.log(\"ca-ES\", idiomas.getFallbacks(\"ca-ES\"));\n        if (lang.length > 2) {\n            idiomasJerarquia.push(...new Set([...idiomas.getFallbacksDOWN(lang)]));\n        }\n        else {\n            idiomasJerarquia.push(...new Set([...idiomas.getFallbacksUP(lang), ...idiomas.getFallbacksDOWN(lang)]));\n        }\n        return idiomasJerarquia;\n    }\n    calcularLang(lang, submodulos = this.submodulosFinales, valores = this.valoresFinales) {\n        const langs = [];\n        for (const valor of valores) {\n            const idioma = valor.getIdioma(this.getJerarquiaIdiomas(lang));\n            if (idioma != undefined && !langs.includes(idioma)) {\n                langs.push(idioma);\n            }\n        }\n        for (const valor of submodulos) {\n            const idioma = valor.calcularLang(lang);\n            if (!langs.includes(idioma)) {\n                langs.push(idioma);\n            }\n        }\n        switch (langs.length) {\n            case 0:\n                return \"_\";\n            case 1:\n                return langs[0];\n            default:\n                return lang;\n        }\n    }\n    async regenerarEjecutar(classdir, lang, submodulos, valores, idiomas) {\n        if (!idiomas.includes(lang)) {\n            idiomas.push(lang);\n        }\n        const contenido = claseTMPL({\n            id: this.id,\n            jerarquia: this.jerarquia,\n            version: Fecha.generarVersion(this.version),\n            hash: this.hash,\n            className: this.className,\n            valores,\n            submodulos,\n        });\n        const promesas = [];\n        for (const lang of [...idiomas]) {\n            const dir = `${classdir}/.src/${lang.replace(\"-\", \"\")}/${this.jerarquia.join(\"/\").replaceAll(\"-\", \"_\")}`;\n            await mkdir(dir, true);\n            promesas.push(safeWrite(`${dir}/index.ts`, contenido, true));\n            const jerarquia = this.getJerarquiaIdiomas(lang);\n            for (const value of valores) {\n                promesas.push(value.write(dir, jerarquia));\n            }\n        }\n        await Promise.all(promesas);\n        for (const value of valores) {\n            value.clean();\n        }\n    }\n    addWatch(classdir) {\n        const dir = `${this.config.jsondir}/${this.jerarquia.join(\"/\")}`;\n        watch(`${dir}/_metadata.json`, async (_, filename) => {\n            console.log(\"Cambios en \", `${dir}/_metadata.json`, filename);\n            this.regenerar(classdir).then(() => { }).catch(() => { });\n        });\n        watch(`${dir}/_values.json`, async (_, filename) => {\n            console.log(\"Cambios en \", `${dir}/_values.json`, filename);\n            this.regenerar(classdir).then(() => { }).catch(() => { });\n        });\n        for (const modulo of this.submodulos) {\n            modulo.addWatch(classdir);\n        }\n    }\n}\n","import { TraduccionTipo } from \"../traduccion\";\nfunction getImports(jerarquia, valores, submodulos) {\n    const tipos = [];\n    for (const valor of valores) {\n        if (!tipos.includes(valor.tipo)) {\n            tipos.push(valor.tipo);\n        }\n    }\n    tipos.sort();\n    const imports = [];\n    if (tipos.includes(\"map\")) {\n        imports.push(`import {ITraduccionMapKeys} from \"services-comun/modules/traduccion/map\";`);\n    }\n    if (imports.length > 0) {\n        imports.push(\"\");\n    }\n    if (submodulos.length > 0) {\n        for (const modulo of submodulos) {\n            const id = modulo.base_id.replaceAll(\"-\", \"_\");\n            imports.push(`import type {${modulo.className}} from \"./${id}\";`);\n        }\n    }\n    imports.push(`import {checkClean} from \"../${`../`.repeat(jerarquia.length - 1)}langs\";`);\n    if (imports.length > 0) {\n        imports.push(\"\");\n        imports.push(\"\");\n    }\n    return imports.join(\"\\n\");\n}\nfunction getParams(valores) {\n    const tipos = [];\n    const params = [];\n    for (const valor of valores) {\n        if (valor.params == undefined || valor.params.length == 0) {\n            continue;\n        }\n        tipos.push(`export type ${valor.className}Param = \"${valor.params.toSorted().join(`\" | \"`)}\";`);\n        params.push(`export type ${valor.className}Params = Record<${valor.className}Param, string|number>;`);\n    }\n    const salida = [];\n    if (tipos.length > 0) {\n        salida.push(tipos.join(\"\\n\"));\n        if (params.length > 0) {\n            salida.push(\"\");\n        }\n    }\n    if (params.length > 0) {\n        salida.push(params.join(\"\\n\"));\n    }\n    if (salida.length > 0) {\n        salida.push(\"\");\n        salida.push(\"\");\n    }\n    return salida.join(\"\\n\");\n}\nfunction getKeys(valores) {\n    const keys = [];\n    for (const valor of valores) {\n        if (valor.keys == undefined) {\n            continue;\n        }\n        const key = [];\n        for (const actual of valor.keys) {\n            key.push(`    \"${actual}\"?: string;`);\n        }\n        const actual = [];\n        actual.push(`export interface ${valor.className}Record extends ITraduccionMapKeys {\\n${key.join(\"\\n\")}\\n}`);\n        actual.push(`export type ${valor.className}Keys = keyof ${valor.className}Record;`);\n        keys.push(actual.join(\"\\n\"));\n        keys.push(\"\");\n    }\n    if (keys.length > 0) {\n        keys.push(\"\");\n    }\n    return keys.join(\"\\n\");\n}\nfunction getInterface(className, valores, submodulos) {\n    const salida = [];\n    for (const submodulo of submodulos) {\n        const id = submodulo.base_id.replaceAll(\"-\", \"_\");\n        salida.push(`    ${id}: ${submodulo.className};`);\n    }\n    for (const valor of valores) {\n        const id = valor.id.replaceAll(\"-\", \"_\");\n        switch (valor.tipo) {\n            case TraduccionTipo.literal:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    ${id}: string;`);\n                }\n                else {\n                    salida.push(`    ${id}: (params?: Partial<${valor.className}Params>)=>string;`);\n                }\n                break;\n            case TraduccionTipo.plural:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    ${id}: (i: number)=>string;`);\n                }\n                else {\n                    salida.push(`    ${id}: (i: number, params?: Partial<${valor.className}Params>)=>string;`);\n                }\n                break;\n            case TraduccionTipo.set:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    ${id}: (i: number)=>string;`);\n                }\n                else {\n                    salida.push(`    ${id}: (i: number, params?: Partial<${valor.className}Params>)=>string;`);\n                }\n                break;\n            case TraduccionTipo.map:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    ${id}: (key: ${valor.className}Keys)=>string;`);\n                }\n                else {\n                    salida.push(`    ${id}: (key: ${valor.className}Keys, params?: Partial<${valor.className}Params>)=>string;`);\n                }\n                break;\n        }\n    }\n    return `export interface ${className} {\\n${salida.sort().join(\"\\n\")}\\n}`;\n}\nexport default ({ id, jerarquia, className, valores, submodulos, lang, mapping }) => {\n    valores.sort((a, b) => a.className.localeCompare(b.className));\n    return `// NO EDITAR A MANO\n${getImports(jerarquia, valores, submodulos)}${getParams(valores)}${getKeys(valores)}${getInterface(className, valores, submodulos)}\n\nconst MAPPING: Record<string, string> = ${JSON.stringify(mapping, null, 4)};\n\nexport default (lang: string, defecto${lang != undefined ? \"?\" : \"\"}: string): Promise<${className}> => import(/* webpackChunkName: \"i18n/[request]/${id}\" */ \\`i18n/.src/$\\{checkClean(lang, defecto, MAPPING)}/${id.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\\`).then(module=> module.default);\n`;\n};\n","function getImports(id, jerarquia, className, langs, mapping) {\n    const imports = [];\n    imports.push(`import type {${className}} from \".\";`);\n    imports.push(`import {check, type Langs} from \"../${\"../\".repeat(jerarquia.length - 1)}langs\";`);\n    imports.sort();\n    imports.push(\"\");\n    const imports2 = [];\n    const importados = [];\n    for (const lang of langs) {\n        const idioma = mapping[lang] == undefined ?\n            lang.replace(\"-\", \"\") :\n            mapping[lang].replace(\"-\", \"\");\n        if (importados.includes(idioma)) {\n            continue;\n        }\n        imports2.push(`import ${idioma} from \"../${\"../\".repeat(jerarquia.length - 1)}.src/${idioma}/${id.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";`);\n        importados.push(idioma);\n    }\n    imports.push(imports2.sort().join(\"\\n\"));\n    return imports.join(\"\\n\");\n}\nexport default ({ id, jerarquia, className, lang, langs, mapping }) => {\n    return `// NO EDITAR A MANO\n${getImports(id, jerarquia, className, langs, mapping)}\n\nconst langs: Record<Langs, ${className}> = {\n${langs.map(lang => `    \"${lang}\": ${mapping[lang] == undefined ? lang.replace(\"-\", \"\") : mapping[lang].replace(\"-\", \"\")},`).join(\"\\n\")}\n};\n\nconst loader = (lang: string, defecto${lang != undefined ? \"?\" : \"\"}: string): ${className} => langs[check(lang, defecto)];\n\nexport {${className}};\nexport default loader;\n`;\n};\n","import { TraduccionTipo } from \"../traduccion\";\nfunction getImports(id, jerarquia, className, valores, submodulos) {\n    const tipos = [];\n    const params = [];\n    for (const valor of valores) {\n        if (!tipos.includes(valor.tipo)) {\n            tipos.push(valor.tipo);\n        }\n        if (valor.keys != undefined) {\n            params.push(`${valor.className}Keys`);\n        }\n        if (valor.params != undefined && valor.params.length > 0) {\n            params.push(`${valor.className}Params`);\n        }\n    }\n    tipos.sort();\n    const imports = [];\n    if (params.length == 0) {\n        imports.push(`import type {${className} as Modulo} from \"../../${\"../\".repeat(jerarquia.length)}${id.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";`);\n    }\n    else {\n        imports.push(`import type {\\n    ${className} as Modulo,\\n    ${params.sort().join(\",\\n    \")}\\n} from \"../../${\"../\".repeat(jerarquia.length)}${id.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";`);\n    }\n    if (submodulos.length > 0) {\n        for (const modulo of submodulos) {\n            const id = modulo.id.replaceAll(\"-\", \"_\");\n            imports.push(`import type {${modulo.className}} from \"../../${\"../\".repeat(jerarquia.length)}${id.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";`);\n        }\n    }\n    if (submodulos.length > 0) {\n        imports.push(\"\");\n        for (const modulo of submodulos) {\n            const id = modulo.base_id.replaceAll(\"-\", \"_\");\n            imports.push(`import ${id} from \"./${id}\";`);\n        }\n    }\n    if (valores.length > 0) {\n        imports.push(\"\");\n        for (const valor of valores) {\n            const id = valor.id.replaceAll(\"-\", \"_\");\n            imports.push(`import ${id} from \"./${id}\";`);\n        }\n    }\n    return imports.join(\"\\n\");\n}\nfunction getPropiedades(valores, submodulos) {\n    const salida1 = [];\n    for (const modulo of submodulos) {\n        const id = modulo.base_id.replaceAll(\"-\", \"_\");\n        salida1.push(`    public readonly ${id}: ${modulo.className};`);\n    }\n    const salida2 = [];\n    for (const valor of valores) {\n        if (valor.tipo == TraduccionTipo.literal && (valor.params == undefined || valor.params.length == 0)) {\n            const id = valor.id.replaceAll(\"-\", \"_\");\n            salida2.push(`    public readonly ${id}: string;`);\n        }\n    }\n    const salida = [];\n    if (salida1.length > 0) {\n        salida.push(salida1.join(\"\\n\"));\n        if (salida2.length > 0) {\n            salida.push(\"\");\n        }\n    }\n    if (salida2.length > 0) {\n        salida.push(salida2.join(\"\\n\"));\n    }\n    if (salida.length > 0) {\n        salida.unshift(\"\");\n        salida.push(\"\");\n    }\n    return salida.join(\"\\n\");\n}\nfunction getConstructor(valores, submodulos) {\n    const salida = [];\n    for (const modulo of submodulos) {\n        const id = modulo.base_id.replaceAll(\"-\", \"_\");\n        salida.push(`        this.${id} = ${id};`);\n    }\n    for (const valor of valores) {\n        const id = valor.id.replaceAll(\"-\", \"_\");\n        if (valor.tipo == TraduccionTipo.literal && (valor.params == undefined || valor.params.length == 0)) {\n            salida.push(`        this.${id} = ${id};`);\n            // } else {\n            //     salida.push(`        this.#${id} = ${id};`);\n        }\n    }\n    return salida.sort().join(\"\\n\");\n}\nfunction getMetodos(valores) {\n    const salida = [];\n    for (const valor of valores) {\n        if (valor.tipo == TraduccionTipo.literal && (valor.params == undefined || valor.params.length == 0)) {\n            continue;\n        }\n        const id = valor.id.replaceAll(\"-\", \"_\");\n        switch (valor.tipo) {\n            case TraduccionTipo.literal:\n                salida.push(`    public ${id}(params: Partial<${valor.className}Params> = {}) { return ${id}.render(params); }`);\n                break;\n            case TraduccionTipo.map:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    public ${id}(key: ${valor.className}Keys) { return ${id}.render(key); }`);\n                }\n                else {\n                    salida.push(`    public ${id}(key: ${valor.className}Keys, params: Partial<${valor.className}Params> = {}) { return ${id}.render(key, params); }`);\n                }\n                break;\n            case TraduccionTipo.plural:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    public ${id}(i: number) { return ${id}.render(i); }`);\n                }\n                else {\n                    salida.push(`    public ${id}(i: number, params: Partial<${valor.className}Params> = {}) { return ${id}.render(i, params); }`);\n                }\n                break;\n            case TraduccionTipo.set:\n                if (valor.params == undefined || valor.params.length == 0) {\n                    salida.push(`    public ${id}(i: number) { return ${id}.render(i); }`);\n                }\n                else {\n                    salida.push(`    public ${id}(i: number, params: Partial<${valor.className}Params> = {}) { return ${id}.render(i, params); }`);\n                }\n                break;\n        }\n    }\n    if (salida.length > 0) {\n        salida.unshift(\"\");\n    }\n    return salida.join(\"\\n\");\n}\nexport default ({ id, jerarquia, version, hash, className, valores, submodulos }) => {\n    valores.sort((a, b) => a.className.localeCompare(b.className));\n    return `// NO EDITAR A MANO\n${getImports(id, jerarquia, className, valores, submodulos)}\n\nclass ${className} implements Modulo {\n    /* STATIC */\n    // public static ID: string = \"${id}\";\n    // public static VERSION: string = \"${version}\";\n    // public static HASH: string = \"${hash}\";\n\n    /* INSTANCE */${getPropiedades(valores, submodulos)}\n    public constructor() {\n${getConstructor(valores, submodulos)}\n    }\n${getMetodos(valores)}\n}\n\nexport default new ${className}();\n`;\n};\n","import { Colors } from \"services-comun/tools/src/mrpack/clases/colors\";\nimport { readDir, unlink } from \"services-comun/modules/utiles/fs\";\nimport { IdiomasLoader } from \"../idioma/loader\";\nimport { Modulo } from \"./\";\nimport { ModuloJSON } from \"./json\";\nimport { TraduccionLoaderMySQL } from \"./traduccion/loader/mysql\";\nimport db from \"../../mysql\";\nexport class ModuloMySQL extends Modulo {\n    /* STATIC */\n    static async getIDS() {\n        const rows = await db.query(\"SELECT `id` FROM `modulos` WHERE `padre` IS NULL AND borrado=0 ORDER BY id\");\n        return rows.map(row => row.id);\n    }\n    static async load(id, paquete, idiomas) {\n        const [[row], langs,] = await Promise.all([\n            db.query(\"SELECT * FROM `modulos` WHERE id=? AND borrado=0\", [id]),\n            idiomas != undefined ? Promise.resolve(idiomas) : IdiomasLoader.fromMySQL(),\n        ]);\n        if (row == undefined) {\n            return Promise.reject(`No existe el modulo ${id}`);\n        }\n        return await this.build(row, langs, paquete);\n    }\n    static async loadPadre(padre, idiomas, paquete) {\n        const rows = await db.query(\"SELECT * FROM `modulos` WHERE padre=? AND borrado=0 ORDER BY id\", [padre]);\n        return await Promise.all(rows.map(row => this.build(row, idiomas, paquete)));\n    }\n    static async build(row, idiomas, paquete) {\n        const modulo = new this({\n            id: row.id,\n            padre: row.padre ?? undefined,\n            descripcion: row.descripcion,\n            idiomas: row.idiomas ?? undefined,\n            version: row.version,\n            hash: row.hash,\n        }, idiomas, {\n            nuevo: false,\n            config: paquete,\n        });\n        await modulo.load();\n        return modulo;\n    }\n    /* INSTANCE */\n    async loadValues() {\n        return TraduccionLoaderMySQL.loadAll(this);\n    }\n    async loadSubmodulos() {\n        return ModuloMySQL.loadPadre(this.id, this.idiomas, this.config.config);\n    }\n    async fixVersion() {\n        if (this.cambio) {\n            console.log(`Corrigiendo hash y versión del módulo ${Colors.colorize([Colors.FgGreen, Colors.Bright], this.id)}`);\n            await db.update(\"UPDATE `modulos` SET `version`=?, `hash`=? WHERE `id`=?\", [this.version, this.hash, this.id]);\n            for (const value of Object.values(this.values)) {\n                await value?.fixVersion();\n            }\n            for (const submodulo of this.submodulos) {\n                await submodulo.fixVersion();\n            }\n        }\n    }\n    async toFile(basedir, config, padre) {\n        config.modulos[this.id] ??= {};\n        const jsondir = `${basedir}/i18n/.json`;\n        const json_viejo = await ModuloJSON.load(jsondir, this.id, this.idiomas, this.config.config, padre).catch(() => undefined);\n        if (json_viejo != undefined) {\n            // await json_viejo.refreshHash();\n            if (json_viejo.hash == this.hash) {\n                console.log(\"No es necesario actualizar\", Colors.colorize([Colors.FgYellow, Colors.Bright], this.id));\n                return;\n            }\n        }\n        const dirJSON = `${jsondir}/${this.jerarquia.join(\"/\")}`;\n        console.log(\"Descargando\", Colors.colorize([Colors.FgGreen, Colors.Bright], this.id));\n        await this.write(dirJSON);\n        // limpiamos submódulos que no existen\n        const ids = [\n            ...this.submodulos.map(actual => actual.base_id),\n            \"_metadata.json\",\n            \"_values.json\",\n        ];\n        for (const file of await readDir(dirJSON)) {\n            if (!ids.includes(file)) {\n                console.log(\"Borrando\", Colors.colorize([Colors.FgYellow, Colors.Bright], `${dirJSON}/${file}`));\n                await unlink(`${dirJSON}/${file}`);\n            }\n        }\n        const json_nuevo = await ModuloJSON.load(dirJSON, this.id, this.idiomas, this.config.config, padre).catch(() => undefined);\n        const include = config.modulos[this.id].include;\n        const exclude = config.modulos[this.id].exclude ?? [];\n        for (const actual of this.submodulos) {\n            if (exclude.includes(actual.base_id)) {\n                continue;\n            }\n            if (include != undefined && !include.includes(actual.base_id)) {\n                continue;\n            }\n            await actual.toFile(basedir, config, json_nuevo);\n        }\n    }\n}\n","import { createHash } from \"node:crypto\";\nimport { safeWrite } from \"services-comun/modules/utiles/fs\";\nimport { IdiomasLoader } from \"../../idioma/loader\";\nimport db from \"../../../mysql\";\nexport var TraduccionTipo;\n(function (TraduccionTipo) {\n    TraduccionTipo[\"literal\"] = \"literal\";\n    TraduccionTipo[\"plural\"] = \"plural\";\n    TraduccionTipo[\"set\"] = \"set\";\n    TraduccionTipo[\"map\"] = \"map\";\n})(TraduccionTipo || (TraduccionTipo = {}));\nexport var TraduccionOrigen;\n(function (TraduccionOrigen) {\n    TraduccionOrigen[\"auto\"] = \"auto\";\n    TraduccionOrigen[\"interno\"] = \"interno\";\n    TraduccionOrigen[\"externo\"] = \"externo\";\n})(TraduccionOrigen || (TraduccionOrigen = {}));\nexport class Traduccion {\n    modulo;\n    id;\n    original;\n    nuevo;\n    /* STATIC */\n    static limpiarId(id) {\n        return id\n            .split(\".\")\n            .map((v) => v[0].toUpperCase() + v.substring(1))\n            .join(\"\")\n            .split(\"_\")\n            .map((v) => v[0].toUpperCase() + v.substring(1))\n            .join(\"\")\n            .split(\"-\")\n            .map((v) => v[0].toUpperCase() + v.substring(1))\n            .join(\"\");\n    }\n    /* INSTANCE */\n    origen;\n    tipo;\n    params;\n    data;\n    descripcion;\n    idiomas;\n    customIdiomas;\n    version;\n    hash;\n    className;\n    contenido;\n    constructor(modulo, id, original, nuevo = false) {\n        this.modulo = modulo;\n        this.id = id;\n        this.original = original;\n        this.nuevo = nuevo;\n        this.origen = original.origen;\n        this.tipo = original.tipo;\n        this.params = original.params;\n        this.data = original.data;\n        this.data.valor ??= {};\n        this.descripcion = original.descripcion;\n        if (original.idiomas == undefined) {\n            this.idiomas = modulo.idiomas;\n            this.customIdiomas = undefined;\n        }\n        else {\n            this.idiomas = IdiomasLoader.fromJSON(original.idiomas);\n            this.customIdiomas = this.idiomas;\n        }\n        this.version = original.version;\n        this.hash = original.hash;\n        this.className = `${this.modulo.className}${Traduccion.limpiarId(this.id)}`;\n        this.contenido = {};\n    }\n    toJSON() {\n        return {\n            id: this.id,\n            descripcion: this.descripcion,\n            origen: this.origen,\n            tipo: this.tipo,\n            params: this.params,\n            values: this.data,\n            idiomas: this.customIdiomas?.toJSON(),\n            version: this.version.toISOString(),\n            hash: this.hash\n        };\n    }\n    async refreshHash() {\n        const hash = createHash(\"md5\").update(JSON.stringify({\n            // modulo: this.modulo.id,\n            // id: this.id,\n            origen: this.origen,\n            tipo: this.tipo,\n            params: this.params,\n            values: this.data,\n            descripcion: this.descripcion,\n            idiomas: this.idiomas,\n        })).digest(\"hex\");\n        if (hash != this.hash) {\n            this.version = new Date();\n            this.hash = hash;\n        }\n        return this.hash;\n    }\n    async guardar() {\n        const params = this.params == undefined ? null : JSON.stringify(this.params);\n        const data = this.data == undefined ? null : JSON.stringify(this.data);\n        const idiomas = this.customIdiomas == undefined ? null : JSON.stringify(this.customIdiomas);\n        if (!this.nuevo) {\n            await db.update(\"UPDATE `traducciones` SET `origen`=?, `tipo`=?, `params`=?, `data`=?, `descripcion`=?, `idiomas`=?, `hash`=?, `version`=? WHERE `modulo`=? AND `id`=?\", [this.origen, this.tipo, params, data, this.descripcion, idiomas, this.hash, this.version, this.modulo.id, this.id]);\n        }\n        else {\n            await db.insert(\"INSERT INTO `traducciones` (`modulo`, `id`, `origen`, `tipo`, `params`, `data`, `descripcion`, `idiomas`, `hash`, `version`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?) ON DUPLICATE KEY UPDATE id=id\", [this.modulo.id, this.id, this.origen, this.tipo, params, data, this.descripcion, idiomas, this.hash, this.version]);\n            this.nuevo = false;\n        }\n    }\n    async fixVersion() {\n        await db.update(\"UPDATE `traducciones` SET `hash`=?, `version`=? WHERE `modulo`=? AND `id`=?\", [this.hash, this.version, this.modulo.id, this.id]);\n    }\n    async write(dir, jerarquia) {\n        const key = jerarquia.join(\".\");\n        this.contenido[key] ??= this.template(jerarquia).replaceAll(\"\\\\\", \"\\\\\\\\\");\n        await safeWrite(`${dir}/${this.id.replaceAll(\"-\", \"_\")}.ts`, this.contenido[key]);\n    }\n    clean() {\n        this.contenido = {};\n    }\n    template(jerarquia) {\n        if (this.params == undefined) {\n            return this.templateNoParams(jerarquia);\n        }\n        return this.templateParams(jerarquia, this.params);\n    }\n    getIdioma(idiomas) {\n        for (let i = 0, len = idiomas.length; i < len; i++) {\n            const valor = this.data.valor[idiomas[i]];\n            if (valor != undefined) {\n                return idiomas[i];\n            }\n        }\n        return undefined;\n    }\n}\n","import { Traduccion } from \"..\";\nimport params from \"./params\";\nimport simple from \"./simple\";\nexport class TraduccionLiteral extends Traduccion {\n    /* INSTANCE */\n    constructor(modulo, id, data) {\n        super(modulo, id, data);\n    }\n    valores(jerarquia) {\n        for (const idioma of jerarquia) {\n            if (this.data.valor[idioma] != undefined) {\n                return this.data.valor[idioma];\n            }\n        }\n        return this.data.defecto ?? this.id.toUpperCase();\n    }\n    templateNoParams(jerarquia) {\n        return simple({\n            id: this.id,\n            modulo: this.modulo.id,\n            valores: this.valores(jerarquia),\n        });\n    }\n    templateParams(jerarquia, parametros) {\n        return params({\n            id: this.id,\n            modulo: this.modulo.id,\n            className: this.className,\n            params: parametros,\n            valores: this.valores(jerarquia),\n        });\n    }\n}\n","export default ({ id, modulo, valores }) => `// NO EDITAR A MANO\n// const id = \"${modulo}.${id}\";\nconst valor = \\`${valores}\\`;\n\nexport default valor;\n`;\n// export default ({id, modulo, valores}: ITemplate)=>`// NO EDITAR A MANO\n// import {TraduccionLiteral} from \"services-comun/modules/traduccion/literal\";\n//\n// const id = \"${modulo}.${id}\";\n// const valor = \\`${valores}\\`;\n//\n// export default new TraduccionLiteral({\n//     id,\n// }, valor);\n// `;\n","export default ({ id, modulo, className, params, valores }) => `// NO EDITAR A MANO\nimport {TraduccionLiteral} from \"services-comun/modules/traduccion/literal\";\n\nimport type {${className}Params} from \"../../${\"../\".repeat(modulo.split(\".\").length)}${modulo.replaceAll(\"-\", \"_\").replaceAll('.', '/')}\";\n\nconst id = \"${modulo}.${id}\";\nconst params: string[] = [${params.map(param => `\"${param}\"`).join(\", \")}];\nconst valor = \\`${valores}\\`;\n\nexport default new TraduccionLiteral<${className}Params>({\n    id,\n    params,\n}, valor);\n`;\n","export class TraduccionLoader {\n}\n","import { TraduccionTipo } from \"..\";\nimport { TraduccionLiteral } from \"../literal\";\nimport { TraduccionLoader } from \".\";\nimport { TraduccionMap } from \"../map\";\nimport { TraduccionPlural } from \"../plural\";\nimport { TraduccionSet } from \"../set\";\nimport db from \"../../../../mysql\";\nexport class TraduccionLoaderMySQL extends TraduccionLoader {\n    static async build(modulo, id, data) {\n        if (data.data == undefined) {\n            return Promise.reject(`No hay datos para la traduccion ${id} del modulo ${modulo.id}`);\n        }\n        switch (data.tipo) {\n            case TraduccionTipo.literal:\n                return new TraduccionLiteral(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params ?? undefined,\n                    data: data.data,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas ?? undefined,\n                    version: data.version,\n                    hash: data.hash,\n                });\n            case TraduccionTipo.plural:\n                return new TraduccionPlural(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params ?? undefined,\n                    data: data.data,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas ?? undefined,\n                    version: data.version,\n                    hash: data.hash,\n                });\n            case TraduccionTipo.set:\n                return new TraduccionSet(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params ?? undefined,\n                    data: data.data,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas ?? undefined,\n                    version: data.version,\n                    hash: data.hash,\n                });\n            case TraduccionTipo.map:\n                return new TraduccionMap(modulo, id, {\n                    origen: data.origen,\n                    tipo: data.tipo,\n                    params: data.params ?? undefined,\n                    data: data.data,\n                    descripcion: data.descripcion,\n                    idiomas: data.idiomas ?? undefined,\n                    version: data.version,\n                    hash: data.hash,\n                });\n        }\n        return Promise.reject(`Tipo de traduccion desconocido ${data.tipo} para la traduccion ${id} del modulo ${modulo.id}`);\n    }\n    static async existe(modulo, id) {\n        const [data] = await db.query(\"SELECT `id` FROM `traducciones` WHERE `modulo`=? AND `id`=? AND `borrado`=0\", [modulo.id, id]);\n        return data != undefined;\n    }\n    // public static async load(modulo: Modulo, id: string): Promise<Traduccion> {\n    //     const [data] = await db.query<ITraduccionMySQL>(\"SELECT `tipo`, `params`, `data`, `descripcion`, `idiomas`, `assets`, `version`, `hash` FROM `traducciones` WHERE `modulo`=? AND `id`=?\", [modulo.id, id]);\n    //     if (data==undefined) {\n    //         return Promise.reject(`No existe la traduccion ${id} del modulo ${modulo.id}`);\n    //     }\n    //\n    //     return this.build(modulo, id, data);\n    // }\n    static async loadAll(modulo) {\n        const data = await db.query(\"SELECT `id`, `origen`, `tipo`, `params`, `data`, `descripcion`, `idiomas`, `version`, `hash` FROM `traducciones` WHERE `modulo`=? AND `borrado`=0\", [modulo.id]);\n        const result = [];\n        for (const traduccion of data) {\n            result.push(this.build(modulo, traduccion.id, traduccion));\n        }\n        const resultados = await Promise.all(result);\n        const salida = {};\n        for (const traduccion of resultados) {\n            salida[traduccion.id] = traduccion;\n        }\n        return salida;\n    }\n}\n","import { Traduccion } from \"..\";\nimport params from \"./params\";\nimport simple from \"./simple\";\nexport class TraduccionMap extends Traduccion {\n    /* INSTANCE */\n    keys;\n    constructor(modulo, id, original, nuevo = false) {\n        super(modulo, id, original, nuevo);\n        this.keys = [];\n        for (const valor of Object.values(this.data.valor ?? {})) {\n            this.keys.push(...Object.keys(valor.valores).filter(key => !this.keys.includes(key)).map(key => key));\n        }\n        this.keys.push(...Object.keys(this.data.defecto?.valores ?? {}).filter(key => !this.keys.includes(key)).map(key => key));\n    }\n    valores(jerarquia) {\n        const salida = {\n            valores: {},\n            defecto: this.defecto(jerarquia),\n        };\n        for (const key of this.keys) {\n            const valor = this.valor(key, jerarquia);\n            if (valor != undefined) {\n                salida.valores[key] = valor;\n            }\n        }\n        return salida;\n    }\n    valor(key, jerarquia) {\n        for (const idioma of jerarquia) {\n            const dato = this.data.valor[idioma];\n            if (dato != undefined) {\n                if (dato.valores[key] != undefined) {\n                    return dato.valores[key];\n                }\n                if (dato.defecto != undefined) {\n                    return dato.defecto;\n                }\n            }\n            if (this.data.defecto == undefined) {\n                continue;\n            }\n            if (this.data.defecto.valores[key] != undefined) {\n                return this.data.defecto.valores[key];\n            }\n        }\n        return undefined;\n    }\n    defecto(jerarquia) {\n        for (const idioma of jerarquia) {\n            const dato = this.data.valor[idioma];\n            if (dato?.defecto != undefined) {\n                return dato.defecto;\n            }\n        }\n        return undefined;\n    }\n    templateNoParams(jerarquia) {\n        const [valores, defecto] = this.parseValores(jerarquia);\n        return simple({\n            id: this.id,\n            modulo: this.modulo.id,\n            className: this.className,\n            keys: this.keys,\n            valores,\n            defecto,\n        });\n    }\n    templateParams(jerarquia, parametros) {\n        const [valores, defecto] = this.parseValores(jerarquia);\n        return params({\n            id: this.id,\n            modulo: this.modulo.id,\n            className: this.className,\n            keys: this.keys,\n            params: parametros,\n            valores,\n            defecto,\n        });\n    }\n    parseValores(jerarquia) {\n        const values = [];\n        const traduccion = this.valores(jerarquia);\n        let defecto = traduccion.defecto;\n        for (const key of this.keys) {\n            const valor = traduccion.valores[key];\n            if (valor != undefined) {\n                values.push(`    \"${key}\": \\`${valor}\\``);\n            }\n            else if (defecto == undefined) {\n                defecto = `${this.modulo.id}.${this.id}`.toUpperCase();\n            }\n        }\n        if (values.length > 0) {\n            return [`{\\n${values.join(\",\\n\")},\\n}`, defecto];\n        }\n        return [`{}`, defecto];\n    }\n}\n","export default ({ id, modulo, className, valores, defecto }) => `// NO EDITAR A MANO\nimport {ITraduccionMapValores, TraduccionMap} from \"services-comun/modules/traduccion/map\";\n\nimport type {${className}Record} from \"../../${\"../\".repeat(modulo.split(\".\").length)}${modulo.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";\n\nconst id = \"${modulo}.${id}\";\nconst valor: ITraduccionMapValores<${className}Record> = ${valores};${defecto == undefined ? \"\" : `\\nconst defecto = \\`${defecto}\\`;`}\n\nexport default new TraduccionMap<${className}Record>({\n    id,\n}, valor${defecto == undefined ? \"\" : \", defecto\"});\n`;\n","export default ({ id, modulo, className, params, valores, defecto }) => `// NO EDITAR A MANO\nimport {ITraduccionMapValores, TraduccionMap} from \"services-comun/modules/traduccion/map\";\n\nimport type {${className}Record, ${className}Params} from \"../../${\"../\".repeat(modulo.split(\".\").length)}${modulo.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";\n\nconst id = \"${modulo}.${id}\";\nconst params: string[] = [${params.map(param => `\"${param}\"`).join(\", \")}];\nconst valor: ITraduccionMapValores<${className}Record> = ${valores};${defecto == undefined ? \"\" : `\\nconst defecto = \\`${defecto}\\`;`}\n\nexport default new TraduccionMap<${className}Record, ${className}Params>({\n    id,\n    params,\n}, valor${defecto == undefined ? \"\" : \", defecto\"});\n`;\n","import { Traduccion } from \"..\";\nimport params from \"./params\";\nimport simple from \"./simple\";\nexport class TraduccionPlural extends Traduccion {\n    /* INSTANCE */\n    herencia;\n    herenciaClass;\n    constructor(modulo, id, data) {\n        // todo convertir Record<string, string> a Record<number, string>\n        super(modulo, id, data);\n        this.herencia = \"plural\";\n        this.herenciaClass = \"Plural\";\n    }\n    valores(jerarquia) {\n        for (const idioma of jerarquia) {\n            if (this.data.valor[idioma] != undefined) {\n                return this.data.valor[idioma];\n            }\n        }\n        return this.data.defecto ?? { \"\": this.id.toUpperCase() };\n    }\n    templateNoParams(jerarquia) {\n        const [valores, defecto] = this.parseValores(jerarquia);\n        return simple({\n            id: this.id,\n            modulo: this.modulo.id,\n            defecto,\n            valores,\n        });\n    }\n    templateParams(jerarquia, parametros) {\n        const [valores, defecto] = this.parseValores(jerarquia);\n        return params({\n            id: this.id,\n            modulo: this.modulo.id,\n            className: this.className,\n            params: parametros,\n            defecto,\n            valores,\n        });\n    }\n    parseValores(jerarquia) {\n        const values = [];\n        const traduccion = this.valores(jerarquia);\n        let defecto = traduccion[\"\"];\n        for (const key of Object.keys(traduccion).filter(key => key != \"\")) {\n            const valor = traduccion[key];\n            values.push(`    ${key}: \\`${valor}\\``);\n        }\n        if (values.length > 0) {\n            return [`{\\n${values.join(\",\\n\")},\\n}`, defecto];\n        }\n        return [`{}`, defecto];\n    }\n}\n","export default ({ id, modulo, defecto, valores }) => `// NO EDITAR A MANO\nimport {TraduccionPlural} from \"services-comun/modules/traduccion/plural\";\n\nconst id = \"${modulo}.${id}\";\nconst defecto = \\`${defecto}\\`;\nconst valores: Record<number, string> = ${valores};\n\nexport default new TraduccionPlural({\n    id,\n}, defecto, valores);\n`;\n","export default ({ id, modulo, className, params, defecto, valores }) => `// NO EDITAR A MANO\nimport {TraduccionPlural} from \"services-comun/modules/traduccion/plural\";\n\nimport type {${className}Params} from \"../../${\"../\".repeat(modulo.split(\".\").length)}${modulo.replaceAll(\"-\", \"_\").replaceAll(\".\", \"/\")}\";\n\nconst id = \"${modulo}.${id}\";\nconst params: string[] = [${params.map(param => `\"${param}\"`).join(\", \")}];\nconst defecto = \\`${defecto}\\`;\nconst valores: Record<number, string> = ${valores};\n\nexport default new TraduccionPlural<${className}Params>({\n    id,\n    params,\n}, defecto, valores);\n`;\n","import { Traduccion } from \"..\";\nimport params from \"./params\";\nimport simple from \"./simple\";\nexport class TraduccionSet extends Traduccion {\n    /* STATIC */\n    /* INSTANCE */\n    herencia;\n    herenciaClass;\n    constructor(modulo, id, data) {\n        super(modulo, id, data);\n        this.herencia = \"set\";\n        this.herenciaClass = \"Set\";\n    }\n    valores(jerarquia) {\n        for (const idioma of jerarquia) {\n            if (this.data.valor[idioma] != undefined) {\n                return this.data.valor[idioma];\n            }\n        }\n        return this.data.defecto ?? {\n            valores: [],\n        };\n    }\n    templateNoParams(jerarquia) {\n        const [valores, defecto] = this.parseValores(jerarquia);\n        return simple({\n            id: this.id,\n            modulo: this.modulo.id,\n            valores,\n            defecto,\n        });\n    }\n    templateParams(jerarquia, parametros) {\n        const [valores, defecto] = this.parseValores(jerarquia);\n        return params({\n            id: this.id,\n            modulo: this.modulo.id,\n            className: this.className,\n            params: parametros,\n            valores,\n            defecto,\n        });\n    }\n    parseValores(jerarquia) {\n        const values = [];\n        const traduccion = this.valores(jerarquia);\n        const defecto = traduccion.defecto;\n        for (const valor of traduccion.valores ?? []) {\n            if (valor != null) {\n                values.push(`    \\`${valor}\\``);\n            }\n            else {\n                values.push(`    undefined`);\n            }\n        }\n        if (values.length > 0) {\n            return [`[\\n${values.join(\",\\n\")},\\n]`, defecto];\n        }\n        return [`[]`, defecto];\n    }\n}\n","export default ({ id, modulo, valores, defecto }) => `// NO EDITAR A MANO\nimport {TraduccionSet, type TValor} from \"services-comun/modules/traduccion/set\";\n\nconst id = \"${modulo}.${id}\";\nconst valores: TValor[] = ${valores};${defecto != undefined ? `\\nconst defecto = \\`${defecto}\\`;` : \"\"}\n\nexport default new TraduccionSet({\n    id,\n}, valores${defecto != undefined ? \", defecto\" : \"\"});\n`;\n","export default ({ id, modulo, className, params, valores, defecto }) => `// NO EDITAR A MANO\nimport {TraduccionSet, type TValor} from \"services-comun/modules/traduccion/set\";\n\nimport type {${className}Params} from \"../../${\"../\".repeat(modulo.split(\".\").length)}${modulo.replaceAll(\"-\", \"_\").replaceAll('.', '/')}\";\n\nconst id = \"${modulo}.${id}\";\nconst params: string[] = [${params.map(param => `\"${param}\"`).join(\", \")}];\nconst valores: TValor[] = ${valores};${defecto != undefined ? `\\nconst defecto = \\`${defecto}\\`;` : \"\"}\n\nexport default new TraduccionSet<${className}Params>({\n    id,\n    params,\n}, valores${defecto != undefined ? \", defecto\" : \"\"});\n`;\n"],"names":["TTimeUnit","Fecha","static","generarFechaMySQL","date","getUTCFullYear","getUTCMonth","slice","getUTCDate","join","generarFechaElastic","options","campos","anno","mes","dia","push","length","generarFechaNatural","generarFechaNaturalConDiaSemana","SEMANA","getUTCDay","generarFechaBloque","generarHora","tz","getUTCHours","getUTCMinutes","getUTCSeconds","generarHoraMinuto","generarMarcaMinuto","generarMarcaMes","Date","generarVersion","generarFechaHoraMySQL","generarFechaHoraNatural","generarFechaHoraNaturalConDiaSemana","generarIntervaloFechasNatural","inicio","fin","getDate","getMonth","getFullYear","this","MESES","generarDateDesdeMySQL","mysql","dateParts","split","map","part","parseInt","UTC","ignoraTZ","getHours","getMinutes","getSeconds","getMilliseconds","generarLog","determineDiffTime","ms","result","time","unit","MILLISECOND","parseFloat","toFixed","DAY","HOUR","MINUTE","SECOND","timeZone","toLocaleString","Idiomas","defecto","codes","fallbacks","fallbacksDown","constructor","init","Object","keys","key","values","value","padres","lang","salida","antecesores","undefined","antecesor","includes","Set","sort","toJSON","getFallbacksUP","idioma","getFallbacksDOWN","getKeys","IdiomasLoader","version","fromMySQL","fecha","query","fromJSON","data","super","reload","basedir","console","error","colorize","FgRed","addWatch","watch","async","_","filename","log","then","catch","Modulo","config","limpiarId","id","v","toUpperCase","substring","padre","descripcion","idiomas","customIdiomas","hash","jerarquia","submodulos","base_id","cambio","className","original","at","toISOString","load","loadValues","loadSubmodulos","refreshHash","traducciones","entries","submodulo","createHash","update","JSON","stringify","digest","write","dir","actual","filter","TraduccionLoaderJSON","build","modulo","tipo","literal","origen","params","plural","set","Promise","reject","loadAll","traduccion","auto","resultados","all","ModuloJSON","jsondir","paquete","row","nuevo","borrar","loadPadre","files","hijos","file","hijo","preparePush","FgYellow","quitarSubmodulo","i","indexOf","splice","toMySQL","FgGreen","insert","existe","guardar","submodulosFinales","include","modulos","exclude","valoresFinales","valores","regenerar","classdir","interfaceDir","replaceAll","langs","mapping","seleccionado","calcularLang","promesas","regenerarEjecutar","a","b","localeCompare","tipos","valor","imports","repeat","toSorted","getParams","getInterface","imports2","importados","replace","getJerarquiaIdiomas","idiomasJerarquia","getIdioma","contenido","getImports","salida1","salida2","unshift","getPropiedades","getConstructor","getMetodos","clase","clean","ModuloMySQL","getIDS","resolve","rows","fixVersion","Bright","toFile","json_viejo","dirJSON","ids","json_nuevo","TraduccionTipo","TraduccionOrigen","Traduccion","template","templateNoParams","templateParams","len","TraduccionLiteral","simple","parametros","param","TraduccionLoader","TraduccionLoaderMySQL","TraduccionMap","dato","parseValores","TraduccionPlural","herencia","herenciaClass","TraduccionSet"],"sourceRoot":""}