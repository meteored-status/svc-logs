{"version":3,"file":"plugins/mrlang/push.js","mappings":"yIAIO,MAAMA,EAET,gBAAaC,CAAIC,GACb,UAAW,QAAO,GAAGA,mCACjB,OAAOC,QAAQC,OAAO,2EAE1B,MAAM,OAAEC,SAAiB,QAAS,GAAGH,uBAC/BI,EAAU,GAAGJ,eACnB,UAAW,QAAMI,GAEb,OADAC,QAAQC,MAAM,0BAA2BF,GAClCH,QAAQC,SAEnB,UAAW,QAAO,GAAGE,kBACjB,OAAOH,QAAQC,OAAO,6BAE1B,MAAMK,EAAMC,OAAOC,KAAKN,EAAOO,SACzBC,EAAU,IAAcC,eAAe,QAAS,GAAGR,mBACnDM,QAAgBT,QAAQY,IAAIN,EAAIO,KAAIC,GAAM,IAAWC,KAAKZ,EAASW,EAAIJ,EAASR,YAChFF,QAAQY,IAAIH,EAAQI,KAAIG,GAAUA,EAAOC,uBACzCjB,QAAQY,IAAIH,EAAQI,KAAIG,GAAUA,EAAOE,mBAEzC,IAAGC,OACb,E","sources":["webpack://services-comun/./tools/src/mrlang/clases/push.ts"],"sourcesContent":["import { isDir, isFile, readJSON } from \"services-comun/modules/utiles/fs\";\nimport { IdiomasLoader } from \"./idioma/loader\";\nimport { ModuloJSON } from \"./modulo/json\";\nimport db from \"../mysql\";\nexport class Push {\n    /* STATIC */\n    static async run(basedir) {\n        if (!await isFile(`${basedir}/i18n/.credenciales/mysql.json`)) {\n            return Promise.reject(\"No hay credenciales en /i18n/.credenciales/ para subir las traducciones\");\n        }\n        const { config } = await readJSON(`${basedir}/i18n/package.json`);\n        const jsondir = `${basedir}/i18n/.json`;\n        if (!await isDir(jsondir)) {\n            console.error(\"No existe el directorio\", jsondir);\n            return Promise.reject();\n        }\n        if (!await isFile(`${jsondir}/idiomas.json`)) {\n            return Promise.reject(\"No hay archivo de idiomas\");\n        }\n        const ids = Object.keys(config.modulos);\n        const idiomas = IdiomasLoader.fromJSON(await readJSON(`${jsondir}/idiomas.json`));\n        const modulos = await Promise.all(ids.map(id => ModuloJSON.load(jsondir, id, idiomas, config)));\n        await Promise.all(modulos.map(modulo => modulo.preparePush()));\n        await Promise.all(modulos.map(modulo => modulo.toMySQL()));\n        // console.log(modulos.map(modulo => modulo.print()));\n        await db.close();\n    }\n}\n"],"names":["Push","run","basedir","Promise","reject","config","jsondir","console","error","ids","Object","keys","modulos","idiomas","fromJSON","all","map","id","load","modulo","preparePush","toMySQL","close"],"sourceRoot":""}